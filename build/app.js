/*! For license information please see app.js.LICENSE.txt */
(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var i=n.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const r=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=r>>2,l=(3&r)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),i.push(n[u],n[l],n[h],n[d])}return i.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){const r=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==r||null==s||null==o||null==a)throw Error();const c=r<<2|s>>4;if(i.push(c),64!==o){const e=s<<4&240|o>>2;if(i.push(e),64!==a){const e=o<<6&192|a;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},i=function(e){return function(e){const i=t(e);return n.encodeByteArray(i,!0)}(e).replace(/\./g,"")};class r{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function s(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function o(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(s())}function a(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function c(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function u(){const e=s();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function l(){return"object"==typeof indexedDB}function h(){return new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class d extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,d.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,f.prototype.create)}}class f{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],s=r?function(e,t){return e.replace(p,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new d(i,o,n)}}const p=/\{\$([^}]+)}/g;function m(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(g(n)&&g(s)){if(!m(n,s))return!1}else if(n!==s)return!1}for(const e of i)if(!n.includes(e))return!1;return!0}function g(e){return null!==e&&"object"==typeof e}function y(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function v(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function w(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class b{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=I),void 0===i.error&&(i.error=I),void 0===i.complete&&(i.complete=I);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function I(){}function T(e,t=1e3,n=2){const i=t*Math.pow(n,e),r=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+r)}function _(e){return e&&e._delegate?e._delegate:e}class E{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const S="[DEFAULT]";class k{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:S})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e="[DEFAULT]"){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e="[DEFAULT]"){return this.instances.has(e)}getOptions(e="[DEFAULT]"){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===S?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var i;return n||null}normalizeInstanceIdentifier(e="[DEFAULT]"){return this.component?this.component.multipleInstances?e:S:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class C{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new k(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const A=[];var N,R;(R=N||(N={}))[R.DEBUG=0]="DEBUG",R[R.VERBOSE=1]="VERBOSE",R[R.INFO=2]="INFO",R[R.WARN=3]="WARN",R[R.ERROR=4]="ERROR",R[R.SILENT=5]="SILENT";const D={debug:N.DEBUG,verbose:N.VERBOSE,info:N.INFO,warn:N.WARN,error:N.ERROR,silent:N.SILENT},O=N.INFO,L={[N.DEBUG]:"log",[N.VERBOSE]:"log",[N.INFO]:"info",[N.WARN]:"warn",[N.ERROR]:"error"},x=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),r=L[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${e.name}:`,...n)};class P{constructor(e){this.name=e,this._logLevel=O,this._logHandler=x,this._userLogHandler=null,A.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in N))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?D[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,N.DEBUG,...e),this._logHandler(this,N.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,N.VERBOSE,...e),this._logHandler(this,N.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,N.INFO,...e),this._logHandler(this,N.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,N.WARN,...e),this._logHandler(this,N.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,N.ERROR,...e),this._logHandler(this,N.ERROR,...e)}}let M,U;const F=new WeakMap,V=new WeakMap,q=new WeakMap,j=new WeakMap,B=new WeakMap;let $={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return V.get(e);if("objectStoreNames"===t)return e.objectStoreNames||q.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return z(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function H(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(U||(U=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(K(this),e),z(F.get(this))}:function(...e){return z(t.apply(K(this),e))}:function(e,...n){const i=t.call(K(this),e,...n);return q.set(i,e.sort?e.sort():[e]),z(i)}:(e instanceof IDBTransaction&&function(e){if(V.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));V.set(e,t)}(e),n=e,(M||(M=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>n instanceof e))?new Proxy(e,$):e);var t,n}function z(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(z(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&F.set(t,e)})).catch((()=>{})),B.set(t,e),t}(e);if(j.has(e))return j.get(e);const t=H(e);return t!==e&&(j.set(e,t),B.set(t,e)),t}const K=e=>B.get(e);function G(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=z(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(z(o.result),e.oldVersion,e.newVersion,z(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}const W=["get","getKey","getAll","getAllKeys","count"],Q=["put","add","delete","clear"],Y=new Map;function X(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Y.get(t))return Y.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=Q.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!W.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&s.done]))[0]};return Y.set(t,s),s}var J;J=$,$={...J,get:(e,t,n)=>X(e,t)||J.get(e,t,n),has:(e,t)=>!!X(e,t)||J.has(e,t)};class Z{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ee="@firebase/app",te="0.7.32",ne=new P("@firebase/app"),ie={[ee]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},re=new Map,se=new Map;function oe(e,t){try{e.container.addComponent(t)}catch(n){ne.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ae(e){const t=e.name;if(se.has(t))return ne.debug(`There were multiple attempts to register component ${t}.`),!1;se.set(t,e);for(const t of re.values())oe(t,e);return!0}function ce(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const ue=new f("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class le{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new E("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ue.create("app-deleted",{appName:this._name})}}const he="9.9.4";function de(e="[DEFAULT]"){const t=re.get(e);if(!t)throw ue.create("no-app",{appName:e});return t}function fe(e,t,n){var i;let r=null!==(i=ie[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${r}" with version "${t}":`];return s&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ne.warn(e.join(" "))}ae(new E(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}const pe="firebase-heartbeat-store";let me=null;function ge(){return me||(me=G("firebase-heartbeat-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(pe)}}).catch((e=>{throw ue.create("idb-open",{originalErrorMessage:e.message})}))),me}async function ye(e,t){var n;try{const n=(await ge()).transaction(pe,"readwrite"),i=n.objectStore(pe);return await i.put(t,ve(e)),n.done}catch(e){if(e instanceof d)ne.warn(e.message);else{const t=ue.create("idb-set",{originalErrorMessage:null===(n=e)||void 0===n?void 0:n.message});ne.warn(t.message)}}}function ve(e){return`${e.name}!${e.options.appId}`}class we{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ie(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=be();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=be(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let i=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),Te(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Te(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=i(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function be(){return(new Date).toISOString().substring(0,10)}class Ie{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!l()&&h().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){var t;try{return(await ge()).transaction(pe).objectStore(pe).get(ve(e))}catch(e){if(e instanceof d)ne.warn(e.message);else{const n=ue.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});ne.warn(n.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Te(e){return i(JSON.stringify({version:2,heartbeats:e})).length}ae(new E("platform-logger",(e=>new Z(e)),"PRIVATE")),ae(new E("heartbeat",(e=>new we(e)),"PRIVATE")),fe(ee,te,""),fe(ee,te,"esm2017"),fe("fire-js",""),fe("firebase","9.9.4","app");const _e="@firebase/installations",Ee="0.5.12",Se="w:0.5.12",ke=new f("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Ce(e){return e instanceof d&&e.code.includes("request-failed")}function Ae({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function Ne(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Re(e,t){const n=(await t.json()).error;return ke.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function De({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Oe(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Le(e){return new Promise((t=>{setTimeout(t,e)}))}const xe=/^[cdef][\w-]{21}$/;function Pe(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}(e);return xe.test(t)?t:""}catch(e){return""}}function Me(e){return`${e.appName}!${e.appId}`}const Ue=new Map;function Fe(e,t){const n=Me(e);Ve(n,t),function(e,t){const n=(!qe&&"BroadcastChannel"in self&&(qe=new BroadcastChannel("[Firebase] FID Change"),qe.onmessage=e=>{Ve(e.data.key,e.data.fid)}),qe);n&&n.postMessage({key:e,fid:t}),0===Ue.size&&qe&&(qe.close(),qe=null)}(n,t)}function Ve(e,t){const n=Ue.get(e);if(n)for(const e of n)e(t)}let qe=null;const je="firebase-installations-store";let Be=null;function $e(){return Be||(Be=G("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(je)}})),Be}async function He(e,t){const n=Me(e),i=(await $e()).transaction(je,"readwrite"),r=i.objectStore(je),s=await r.get(n);return await r.put(t,n),await i.done,s&&s.fid===t.fid||Fe(e,t.fid),t}async function ze(e){const t=Me(e),n=(await $e()).transaction(je,"readwrite");await n.objectStore(je).delete(t),await n.done}async function Ke(e,t){const n=Me(e),i=(await $e()).transaction(je,"readwrite"),r=i.objectStore(je),s=await r.get(n),o=t(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||Fe(e,o.fid),o}async function Ge(e){let t;const n=await Ke(e.appConfig,(n=>{const i=function(e){return Ye(e||{fid:Pe(),registrationStatus:0})}(n),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(ke.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const i=Ae(e),r=De(e),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={fid:n,authVersion:"FIS_v2",appId:e.appId,sdkVersion:Se},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await Oe((()=>fetch(i,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:Ne(e.authToken)}}throw await Re("Create Installation",c)}(e,t);return He(e.appConfig,n)}catch(n){throw Ce(n)&&409===n.customData.serverCode?await ze(e.appConfig):await He(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:We(e)}:{installationEntry:t}}(e,i);return t=r.registrationPromise,r.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function We(e){let t=await Qe(e.appConfig);for(;1===t.registrationStatus;)await Le(100),t=await Qe(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Ge(e);return n||t}return t}function Qe(e){return Ke(e,(e=>{if(!e)throw ke.create("installation-not-found");return Ye(e)}))}function Ye(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Xe({appConfig:e,heartbeatServiceProvider:t},n){const i=function(e,{fid:t}){return`${Ae(e)}/${t}/authTokens:generate`}(e,n),r=function(e,{refreshToken:t}){const n=De(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}(t)),n}(e,n),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={installation:{sdkVersion:Se,appId:e.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await Oe((()=>fetch(i,a)));if(c.ok)return Ne(await c.json());throw await Re("Generate Auth Token",c)}async function Je(e,t=!1){let n;const i=await Ke(e.appConfig,(i=>{if(!et(i))throw ke.create("not-registered");const r=i.authToken;if(!t&&(2===(s=r).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(s)))return i;var s;if(1===r.requestStatus)return n=async function(e,t){let n=await Ze(e.appConfig);for(;1===n.authToken.requestStatus;)await Le(100),n=await Ze(e.appConfig);const i=n.authToken;return 0===i.requestStatus?Je(e,t):i}(e,t),i;{if(!navigator.onLine)throw ke.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return n=async function(e,t){try{const n=await Xe(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await He(e.appConfig,i),n}catch(n){if(!Ce(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await He(e.appConfig,n)}else await ze(e.appConfig);throw n}}(e,t),t}}));return n?await n:i.authToken}function Ze(e){return Ke(e,(e=>{if(!et(e))throw ke.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function et(e){return void 0!==e&&2===e.registrationStatus}function tt(e){return ke.create("missing-app-config-values",{valueName:e})}const nt="installations";ae(new E(nt,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw tt("App Configuration");if(!e.name)throw tt("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw tt(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:ce(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),ae(new E("installations-internal",(e=>{const t=ce(e.getProvider("app").getImmediate(),nt).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await Ge(t);return i?i.catch(console.error):Je(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await Ge(e);t&&await t}(n),(await Je(n,t)).token}(t,e)}}),"PRIVATE")),fe(_e,Ee),fe(_e,Ee,"esm2017");const it="analytics",rt="https://www.googletagmanager.com/gtag/js",st=new P("@firebase/analytics");function ot(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const at=new f("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),ct=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function ut(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function lt(e,t=ct,n){const{appId:i,apiKey:r,measurementId:s}=e.options;if(!i)throw at.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw at.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new dt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),ht({appId:i,apiKey:r,measurementId:s},o,a,t)}async function ht(e,{throttleEndTimeMillis:t,backoffCount:n},i,r=ct){var s,o;const{appId:a,measurementId:c}=e;try{await function(e,t){return new Promise(((n,i)=>{const r=Math.max(t-Date.now(),0),s=setTimeout(n,r);e.addEventListener((()=>{clearTimeout(s),i(at.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(i,t)}catch(e){if(c)return st.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null===(s=e)||void 0===s?void 0:s.message}]`),{appId:a,measurementId:c};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,r={method:"GET",headers:ut(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw at.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return r.deleteThrottleMetadata(a),t}catch(t){const s=t;if(!function(e){if(!(e instanceof d&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(s)){if(r.deleteThrottleMetadata(a),c)return st.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null==s?void 0:s.message}]`),{appId:a,measurementId:c};throw t}const u=503===Number(null===(o=null==s?void 0:s.customData)||void 0===o?void 0:o.httpStatus)?T(n,r.intervalMillis,30):T(n,r.intervalMillis),l={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return r.setThrottleMetadata(a,l),st.debug(`Calling attemptFetch again in ${u} millis`),ht(e,l,i,r)}}class dt{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let ft,pt;async function mt(e,t,n,i,r,s,o){var a;const c=lt(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&st.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>st.error(e))),t.push(c);const u=async function(){var e;if(!l())return st.warn(at.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await h()}catch(t){return st.warn(at.create("indexeddb-unavailable",{errorInfo:null===(e=t)||void 0===e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[d,f]=await Promise.all([c,u]);(function(){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(rt))return t;return null})()||function(e,t){const n=document.createElement("script");n.src=`${rt}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(s,d.measurementId),pt&&(r("consent","default",pt),pt=void 0),r("js",new Date);const p=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return p.origin="firebase",p.update=!0,null!=f&&(p.firebase_id=f),r("config",d.measurementId,p),ft&&(r("set",ft),ft=void 0),d.measurementId}class gt{constructor(e){this.app=e}_delete(){return delete yt[this.app.options.appId],Promise.resolve()}}let yt={},vt=[];const wt={};let bt,It,Tt="dataLayer",_t=!1;function Et(e,t,n){!function(){const e=[];if(a()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=at.create("invalid-analytics-context",{errorInfo:t});st.warn(n.message)}}();const i=e.options.appId;if(!i)throw at.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw at.create("no-api-key");st.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=yt[i])throw at.create("already-exists",{id:i});if(!_t){!function(e){let t=[];Array.isArray(window.dataLayer)?t=window.dataLayer:window.dataLayer=t}();const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,r){let s=function(...e){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(s=window.gtag),window.gtag=function(e,t,n,i){return async function(r,s,o){try{"event"===r?await async function(e,t,n,i,r){try{let s=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const i=await ot(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),r=e&&t[e.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",i,r||{})}catch(e){st.error(e)}}(e,t,n,s,o):"config"===r?await async function(e,t,n,i,r,s){const o=i[r];try{if(o)await t[o];else{const e=(await ot(n)).find((e=>e.measurementId===r));e&&await t[e.appId]}}catch(e){st.error(e)}e("config",r,s)}(e,t,n,i,s,o):"consent"===r?e("consent","update",o):e("set",s)}catch(e){st.error(e)}}}(s,e,t,n),{gtagCore:s,wrappedGtag:window.gtag}}(yt,vt,wt);It=e,bt=t,_t=!0}return yt[i]=mt(e,vt,wt,t,bt,Tt,n),new gt(e)}const St="@firebase/analytics",kt="0.8.0";function Ct(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}ae(new E(it,((e,{options:t})=>Et(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),ae(new E("analytics-internal",(function(e){try{const t=e.getProvider(it).getImmediate();return{logEvent:(e,n,i)=>function(e,t,n,i){e=_(e),async function(e,t,n,i,r){if(r&&r.global)e("event",n,i);else{const r=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(It,yt[e.app.options.appId],t,n,i).catch((e=>st.error(e)))}(t,e,n,i)}}catch(e){throw at.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),fe(St,kt),fe(St,kt,"esm2017"),Object.create,Object.create;const At=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Nt=new f("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Rt=new P("@firebase/auth");function Dt(e,...t){Rt.logLevel<=N.ERROR&&Rt.error(`Auth (9.9.4): ${e}`,...t)}function Ot(e,...t){throw xt(e,...t)}function Lt(e,...t){return xt(e,...t)}function xt(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return Nt.create(e,...t)}function Pt(e,t,...n){if(!e)throw xt(t,...n)}function Mt(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Dt(t),new Error(t)}function Ut(e,t){e||Mt(t)}const Ft=new Map;function Vt(e){Ut(e instanceof Function,"Expected a class definition");let t=Ft.get(e);return t?(Ut(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Ft.set(e,t),t)}function qt(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function jt(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Bt{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ut(t>e,"Short delay should be less than long delay!"),this.isMobile=o()||c()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===jt()||"https:"===jt()||a()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function $t(e,t){Ut(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Ht{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Mt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Mt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Mt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const zt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Kt=new Bt(3e4,6e4);function Gt(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Wt(e,t,n,i,r={}){return Qt(e,r,(async()=>{let r={},s={};i&&("GET"===t?s=i:r={body:JSON.stringify(i)});const o=y(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),Ht.fetch()(Xt(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Qt(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},zt),t);try{const t=new Jt(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw Zt(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Zt(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Zt(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Zt(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const i=Object.assign(Object.assign({},At()),{[t]:n});return new f("auth","Firebase",i).create(t,{appName:e.name})}(e,a,o);Ot(e,a)}}catch(t){if(t instanceof d)throw t;Ot(e,"network-request-failed")}}async function Yt(e,t,n,i,r={}){const s=await Wt(e,t,n,i,r);return"mfaPendingCredential"in s&&Ot(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Xt(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?$t(e.config,r):`${e.config.apiScheme}://${r}`}class Jt{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Lt(this.auth,"network-request-failed"))),Kt.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Zt(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Lt(e,t,i);return r.customData._tokenResponse=n,r}function en(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function tn(e){return 1e3*Number(e)}function nn(e){var t;const[i,r,s]=e.split(".");if(void 0===i||void 0===r||void 0===s)return Dt("JWT malformed, contained fewer than 3 sections"),null;try{const e=function(e){try{return n.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}(r);return e?JSON.parse(e):(Dt("Failed to decode base64 JWT payload"),null)}catch(e){return Dt("Caught error parsing JWT payload as JSON",null===(t=e)||void 0===t?void 0:t.toString()),null}}async function rn(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof d&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class sn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null===(e=t)||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class on{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=en(this.lastLoginAt),this.creationTime=en(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function an(e){var t;const n=e.auth,i=await e.getIdToken(),r=await rn(e,async function(e,t){return Wt(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:i}));Pt(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=Ct(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const l=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!l&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new on(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class cn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Pt(e.idToken,"internal-error"),Pt(void 0!==e.idToken,"internal-error"),Pt(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=nn(e);return Pt(t,"internal-error"),Pt(void 0!==t.exp,"internal-error"),Pt(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return Pt(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await Qt(e,{},(async()=>{const n=y({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,s=Xt(e,i,"/v1/token",`key=${r}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Ht.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new cn;return n&&(Pt("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(Pt("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(Pt("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cn,this.toJSON())}_performRefresh(){return Mt("not implemented")}}function un(e,t){Pt("string"==typeof e||void 0===e,"internal-error",{appName:t})}class ln{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=Ct(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new on(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await rn(this,this.stsTokenManager.getToken(this.auth,e));return Pt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=_(e),i=await n.getIdToken(t),r=nn(i);Pt(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:en(tn(r.auth_time)),issuedAtTime:en(tn(r.iat)),expirationTime:en(tn(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=_(e);await an(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Pt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new ln(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){Pt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await an(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await rn(this,async function(e,t){return Wt(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:I,stsTokenManager:T}=t;Pt(v&&T,e,"internal-error");const _=cn.fromJSON(this.name,T);Pt("string"==typeof v,e,"internal-error"),un(l,e.name),un(h,e.name),Pt("boolean"==typeof w,e,"internal-error"),Pt("boolean"==typeof b,e,"internal-error"),un(d,e.name),un(f,e.name),un(p,e.name),un(m,e.name),un(g,e.name),un(y,e.name);const E=new ln({uid:v,auth:e,email:h,emailVerified:w,displayName:l,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:_,createdAt:g,lastLoginAt:y});return I&&Array.isArray(I)&&(E.providerData=I.map((e=>Object.assign({},e)))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(e,t,n=!1){const i=new cn;i.updateFromServerResponse(t);const r=new ln({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await an(r),r}}class hn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}hn.type="NONE";const dn=hn;function fn(e,t,n){return`firebase:${e}:${t}:${n}`}class pn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=fn(this.userKey,i.apiKey,r),this.fullPersistenceKey=fn("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ln._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new pn(Vt(dn),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||Vt(dn);const s=fn(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const i=ln._fromJSON(e,t);n!==r&&(o=i),r=n;break}}catch(e){}const a=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(e){}}))),new pn(r,e,n)):new pn(r,e,n)}}function mn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(wn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(gn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(In(t))return"Blackberry";if(Tn(t))return"Webos";if(yn(t))return"Safari";if((t.includes("chrome/")||vn(t))&&!t.includes("edge/"))return"Chrome";if(bn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function gn(e=s()){return/firefox\//i.test(e)}function yn(e=s()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function vn(e=s()){return/crios\//i.test(e)}function wn(e=s()){return/iemobile/i.test(e)}function bn(e=s()){return/android/i.test(e)}function In(e=s()){return/blackberry/i.test(e)}function Tn(e=s()){return/webos/i.test(e)}function _n(e=s()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function En(e=s()){return _n(e)||bn(e)||Tn(e)||In(e)||/windows phone/i.test(e)||wn(e)}function Sn(e,t=[]){let n;switch(e){case"Browser":n=mn(s());break;case"Worker":n=`${mn(s())}-${e}`;break;default:n=e}return`${n}/JsCore/9.9.4/${t.length?t.join(","):"FirebaseCore-web"}`}class kn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(e){i(e)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){var t;if(this.auth.currentUser===e)return;const n=[];try{for(const t of this.queue)await t(e),t.onAbort&&n.push(t.onAbort)}catch(e){n.reverse();for(const e of n)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===(t=e)||void 0===t?void 0:t.message})}}}class Cn{constructor(e,t,n){this.app=e,this.heartbeatServiceProvider=t,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Nn(this),this.idTokenSubscription=new Nn(this),this.beforeStateQueue=new kn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Nt,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vt(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await pn.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Pt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){var t;try{await an(e)}catch(e){if("auth/network-request-failed"!==(null===(t=e)||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?_(e):null;return t&&Pt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Pt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Vt(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new f("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vt(e)||this._popupRedirectResolver;Pt(t,this,"argument-error"),this.redirectPersistenceManager=await pn.create(this,[Vt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return Pt(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Pt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Sn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());return n&&(t["X-Firebase-Client"]=n),t}}function An(e){return _(e)}class Nn{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new b(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Pt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class Rn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Mt("not implemented")}_getIdTokenResponse(e){return Mt("not implemented")}_linkToIdToken(e,t){return Mt("not implemented")}_getReauthenticationResolver(e){return Mt("not implemented")}}class Dn extends Rn{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Dn(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Dn(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return Yt(e,"POST","/v1/accounts:signInWithPassword",Gt(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Yt(e,"POST","/v1/accounts:signInWithEmailLink",Gt(e,t))}(e,{email:this._email,oobCode:this._password});default:Ot(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return Wt(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Yt(e,"POST","/v1/accounts:signInWithEmailLink",Gt(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Ot(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function On(e,t){return Yt(e,"POST","/v1/accounts:signInWithIdp",Gt(e,t))}class Ln extends Rn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ln(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ot("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=Ct(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Ln(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return On(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,On(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,On(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=y(t)}return e}}const xn={USER_NOT_FOUND:"user-not-found"};class Pn extends Rn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Pn({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Pn({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Yt(e,"POST","/v1/accounts:signInWithPhoneNumber",Gt(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Yt(e,"POST","/v1/accounts:signInWithPhoneNumber",Gt(e,t));if(n.temporaryProof)throw Zt(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Yt(e,"POST","/v1/accounts:signInWithPhoneNumber",Gt(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),xn)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new Pn({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class Mn{constructor(e){var t,n,i,r,s,o;const a=v(w(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Pt(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=v(w(e)).link,n=t?v(w(t)).deep_link_id:null,i=v(w(e)).deep_link_id;return(i?v(w(i)).link:null)||i||n||t||e}(e);try{return new Mn(t)}catch(e){return null}}}class Un{constructor(){this.providerId=Un.PROVIDER_ID}static credential(e,t){return Dn._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Mn.parseLink(t);return Pt(n,"argument-error"),Dn._fromEmailAndCode(e,n.code,n.tenantId)}}Un.PROVIDER_ID="password",Un.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Un.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Fn{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Vn extends Fn{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class qn extends Vn{constructor(){super("facebook.com")}static credential(e){return Ln._fromParams({providerId:qn.PROVIDER_ID,signInMethod:qn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qn.credentialFromTaggedObject(e)}static credentialFromError(e){return qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return qn.credential(e.oauthAccessToken)}catch(e){return null}}}qn.FACEBOOK_SIGN_IN_METHOD="facebook.com",qn.PROVIDER_ID="facebook.com";class jn extends Vn{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ln._fromParams({providerId:jn.PROVIDER_ID,signInMethod:jn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return jn.credentialFromTaggedObject(e)}static credentialFromError(e){return jn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return jn.credential(t,n)}catch(e){return null}}}jn.GOOGLE_SIGN_IN_METHOD="google.com",jn.PROVIDER_ID="google.com";class Bn extends Vn{constructor(){super("github.com")}static credential(e){return Ln._fromParams({providerId:Bn.PROVIDER_ID,signInMethod:Bn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bn.credentialFromTaggedObject(e)}static credentialFromError(e){return Bn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Bn.credential(e.oauthAccessToken)}catch(e){return null}}}Bn.GITHUB_SIGN_IN_METHOD="github.com",Bn.PROVIDER_ID="github.com";class $n extends Vn{constructor(){super("twitter.com")}static credential(e,t){return Ln._fromParams({providerId:$n.PROVIDER_ID,signInMethod:$n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return $n.credentialFromTaggedObject(e)}static credentialFromError(e){return $n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return $n.credential(t,n)}catch(e){return null}}}$n.TWITTER_SIGN_IN_METHOD="twitter.com",$n.PROVIDER_ID="twitter.com";class Hn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await ln._fromIdTokenResponse(e,n,i),s=zn(n);return new Hn({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=zn(n);return new Hn({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function zn(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Kn extends d{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Kn.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Kn(e,t,n,i)}}function Gn(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Kn._fromErrorAndOperation(e,n,t,i);throw n}))}async function Wn(e,t,n=!1){const i="signIn",r=await Gn(e,i,t),s=await Hn._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}new WeakMap;const Qn="__sak";class Yn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Qn,"1"),this.storage.removeItem(Qn),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Xn extends Yn{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=s();return yn(e)||_n(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=En(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);u()&&10===document.documentMode&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Xn.type="LOCAL";const Jn=Xn;class Zn extends Yn{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Zn.type="SESSION";const ei=Zn;class ti{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new ti(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async e=>e(t.origin,r))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ni(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}ti.receivers=[];class ii{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=ni("",20);i.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function ri(){return window}function si(){return void 0!==ri().WorkerGlobalScope&&"function"==typeof ri().importScripts}const oi="firebaseLocalStorageDb",ai="firebaseLocalStorage",ci="fbase_key";class ui{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function li(e,t){return e.transaction([ai],t?"readwrite":"readonly").objectStore(ai)}function hi(){const e=indexedDB.open(oi,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(ai,{keyPath:ci})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(ai)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(oi);return new ui(e).toPromise()}(),t(await hi()))}))}))}async function di(e,t,n){const i=li(e,!0).put({[ci]:t,value:n});return new ui(i).toPromise()}function fi(e,t){const n=li(e,!0).delete(t);return new ui(n).toPromise()}class pi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await hi()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return si()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ti._getInstance(si()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new ii(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}var t}async _isAvailable(){try{if(!indexedDB)return!1;const e=await hi();return await di(e,Qn,"1"),await fi(e,Qn),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>di(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=li(e,!1).get(t),i=await new ui(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>fi(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=li(e,!1).getAll();return new ui(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}pi.type="LOCAL";const mi=pi;function gi(e){return`__${e}${Math.floor(1e6*Math.random())}`}gi("rcb"),new Bt(3e4,6e4);class yi{constructor(e){this.providerId=yi.PROVIDER_ID,this.auth=An(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var i;const r=await n.verify();try{let s;if(Pt("string"==typeof r,e,"argument-error"),Pt("recaptcha"===n.type,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Pt("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Wt(e,"POST","/v2/accounts/mfaEnrollment:start",Gt(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{Pt("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;Pt(n,e,"missing-multi-factor-info");const o=await function(e,t){return Wt(e,"POST","/v2/accounts/mfaSignIn:start",Gt(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Wt(e,"POST","/v1/accounts:sendVerificationCode",Gt(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}(this.auth,e,_(t))}static credential(e,t){return Pn._fromVerification(e,t)}static credentialFromResult(e){const t=e;return yi.credentialFromTaggedObject(t)}static credentialFromError(e){return yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Pn._fromTokenResponse(t,n):null}}yi.PROVIDER_ID="phone",yi.PHONE_SIGN_IN_METHOD="phone";class vi extends Rn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return On(e,this._buildIdpRequest())}_linkToIdToken(e,t){return On(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return On(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function wi(e){return Wn(e.auth,new vi(e),e.bypassAuthState)}function bi(e){const{auth:t,user:n}=e;return Pt(n,t,"internal-error"),async function(e,t,n=!1){var i;const{auth:r}=e,s="reauthenticate";try{const i=await rn(e,Gn(r,s,t,e),n);Pt(i.idToken,r,"internal-error");const o=nn(i.idToken);Pt(o,r,"internal-error");const{sub:a}=o;return Pt(e.uid===a,r,"user-mismatch"),Hn._forOperation(e,s,i)}catch(e){throw"auth/user-not-found"===(null===(i=e)||void 0===i?void 0:i.code)&&Ot(r,"user-mismatch"),e}}(n,new vi(e),e.bypassAuthState)}async function Ii(e){const{auth:t,user:n}=e;return Pt(n,t,"internal-error"),async function(e,t,n=!1){const i=await rn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Hn._forOperation(e,"link",i)}(n,new vi(e),e.bypassAuthState)}class Ti{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return wi;case"linkViaPopup":case"linkViaRedirect":return Ii;case"reauthViaPopup":case"reauthViaRedirect":return bi;default:Ot(this.auth,"internal-error")}}resolve(e){Ut(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ut(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const _i=new Bt(2e3,1e4);class Ei extends Ti{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Ei.currentPopupAction&&Ei.currentPopupAction.cancel(),Ei.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Pt(e,this.auth,"internal-error"),e}async onExecution(){Ut(1===this.filter.length,"Popup operations only handle one event");const e=ni();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Lt(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Lt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ei.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Lt(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,_i.get())};e()}}Ei.currentPopupAction=null;const Si=new Map;class ki extends Ti{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Si.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return fn("pendingRedirect",e.config.apiKey,e.name)}(t),i=function(e){return Vt(e._redirectPersistence)}(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Si.set(this.auth._key(),e)}return this.bypassAuthState||Si.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ci(e,t){Si.set(e._key(),t)}async function Ai(e,t,n=!1){const i=An(e),r=function(e,t){return t?Vt(t):(Pt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(i,t),s=new ki(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}class Ni{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Di(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Di(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Lt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ri(e))}saveEventToCache(e){this.cachedEventUids.add(Ri(e)),this.lastProcessedEventTime=Date.now()}}function Ri(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Di({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Oi=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Li=/^https?/;function xi(e){const t=qt(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Li.test(n))return!1;if(Oi.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Pi=new Bt(3e4,6e4);function Mi(){const e=ri().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let Ui=null;function Fi(e){return Ui=Ui||function(e){return new Promise(((t,n)=>{var i,r,s,o;function a(){Mi(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Mi(),n(Lt(e,"network-request-failed"))},timeout:Pi.get()})}if(null===(r=null===(i=ri().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=ri().gapi)||void 0===s?void 0:s.load)){const t=gi("iframefcb");return ri()[t]=()=>{gapi.load?a():n(Lt(e,"network-request-failed"))},(o=`https://apis.google.com/js/api.js?onload=${t}`,new Promise(((e,t)=>{const n=document.createElement("script");var i,r;n.setAttribute("src",o),n.onload=e,n.onerror=e=>{const n=Lt("internal-error");n.customData=e,t(n)},n.type="text/javascript",n.charset="UTF-8",(null!==(r=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==r?r:document).appendChild(n)}))).catch((e=>n(e)))}a()}})).catch((e=>{throw Ui=null,e}))}(e),Ui}const Vi=new Bt(5e3,15e3),qi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ji=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Bi(e){const t=e.config;Pt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?$t(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:he},r=ji.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${y(i).slice(1)}`}const $i={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Hi{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function zi(e,t,n,i,r,s){Pt(e.config.authDomain,e,"auth-domain-config-required"),Pt(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:he,eventId:r};if(t instanceof Fn){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Vn){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){return e.emulator?$t(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${y(a).slice(1)}`}const Ki="webStorageSupport",Gi=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ei,this._completeRedirectFn=Ai,this._overrideRedirectResult=Ci}async _openPopup(e,t,n,i){var r;return Ut(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(e,t,n,i=500,r=600){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const u=Object.assign(Object.assign({},$i),{width:i.toString(),height:r.toString(),top:o,left:a}),l=s().toLowerCase();n&&(c=vn(l)?"_blank":n),gn(l)&&(t=t||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=s()){var t;return _n(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",c),new Hi(null);const d=window.open(t||"",c,h);Pt(d,e,"popup-blocked");try{d.focus()}catch(e){}return new Hi(d)}(e,zi(e,t,n,qt(),i),ni())}async _openRedirect(e,t,n,i){var r;return await this._originValidation(e),r=zi(e,t,n,qt(),i),ri().location.href=r,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Ut(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await Fi(e),n=ri().gapi;return Pt(n,e,"internal-error"),t.open({where:document.body,url:Bi(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qi,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=Lt(e,"network-request-failed"),s=ri().setTimeout((()=>{i(r)}),Vi.get());function o(){ri().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{i(r)}))}))))}(e),n=new Ni(e);return t.register("authEvent",(t=>(Pt(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ki,{type:Ki},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i.webStorageSupport;void 0!==r&&t(!!r),Ot(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Wt(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(xi(e))return}catch(e){}Ot(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return En()||yn()||_n()}};var Wi,Qi="@firebase/auth",Yi="0.20.6";class Xi{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Pt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}Wi="Browser",ae(new E("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),{apiKey:r,authDomain:s}=n.options;return((e,n)=>{Pt(r&&!r.includes(":"),"invalid-api-key",{appName:e.name}),Pt(!(null==s?void 0:s.includes(":")),"argument-error",{appName:e.name});const i={apiKey:r,authDomain:s,clientPlatform:Wi,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Sn(Wi)},o=new Cn(e,n,i);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Vt);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(o,t),o})(n,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),ae(new E("auth-internal",(e=>(e=>new Xi(e))(An(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),fe(Qi,Yi,void 0),fe(Qi,Yi,"esm2017");var Ji,Zi="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e.g?e.g:"undefined"!=typeof self?self:{},er={},tr=tr||{},nr=Zi||self;function ir(){}function rr(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function sr(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var or="closure_uid_"+(1e9*Math.random()>>>0),ar=0;function cr(e,t,n){return e.call.apply(e.bind,arguments)}function ur(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function lr(e,t,n){return(lr=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?cr:ur).apply(null,arguments)}function hr(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function dr(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}function fr(){this.s=this.s,this.o=this.o}var pr={};fr.prototype.s=!1,fr.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,or)&&e[or]||(e[or]=++ar)}(this);delete pr[e]}},fr.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const mr=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},gr=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){const i=e.length,r="string"==typeof e?e.split(""):e;for(let s=0;s<i;s++)s in r&&t.call(n,r[s],s,e)};function yr(e){return Array.prototype.concat.apply([],arguments)}function vr(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function wr(e){return/^[\s\xa0]*$/.test(e)}var br,Ir=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Tr(e,t){return-1!=e.indexOf(t)}function _r(e,t){return e<t?-1:e>t?1:0}e:{var Er=nr.navigator;if(Er){var Sr=Er.userAgent;if(Sr){br=Sr;break e}}br=""}function kr(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function Cr(e){const t={};for(const n in e)t[n]=e[n];return t}var Ar="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Nr(e,t){let n,i;for(let t=1;t<arguments.length;t++){for(n in i=arguments[t],i)e[n]=i[n];for(let t=0;t<Ar.length;t++)n=Ar[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function Rr(e){return Rr[" "](e),e}Rr[" "]=ir;var Dr,Or,Lr=Tr(br,"Opera"),xr=Tr(br,"Trident")||Tr(br,"MSIE"),Pr=Tr(br,"Edge"),Mr=Pr||xr,Ur=Tr(br,"Gecko")&&!(Tr(br.toLowerCase(),"webkit")&&!Tr(br,"Edge"))&&!(Tr(br,"Trident")||Tr(br,"MSIE"))&&!Tr(br,"Edge"),Fr=Tr(br.toLowerCase(),"webkit")&&!Tr(br,"Edge");function Vr(){var e=nr.document;return e?e.documentMode:void 0}e:{var qr="",jr=(Or=br,Ur?/rv:([^\);]+)(\)|;)/.exec(Or):Pr?/Edge\/([\d\.]+)/.exec(Or):xr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Or):Fr?/WebKit\/(\S+)/.exec(Or):Lr?/(?:Version)[ \/]?(\S+)/.exec(Or):void 0);if(jr&&(qr=jr?jr[1]:""),xr){var Br=Vr();if(null!=Br&&Br>parseFloat(qr)){Dr=String(Br);break e}}Dr=qr}var $r,Hr={};function zr(){return e=Hr,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){let e=0;const t=Ir(String(Dr)).split("."),n=Ir("9").split("."),i=Math.max(t.length,n.length);for(let o=0;0==e&&o<i;o++){var r=t[o]||"",s=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;e=_r(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||_r(0==r[2].length,0==s[2].length)||_r(r[2],s[2]),r=r[3],s=s[3]}while(0==e)}return 0<=e}();var e}nr.document&&xr?$r=Vr()||parseInt(Dr,10)||void 0:$r=void 0;var Kr=$r,Gr=function(){if(!nr.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{nr.addEventListener("test",ir,t),nr.removeEventListener("test",ir,t)}catch(e){}return e}();function Wr(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function Qr(e,t){if(Wr.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Ur){e:{try{Rr(t.nodeName);var r=!0;break e}catch(e){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Yr[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Qr.Z.h.call(this)}}Wr.prototype.h=function(){this.defaultPrevented=!0},dr(Qr,Wr);var Yr={2:"touch",3:"pen",4:"mouse"};Qr.prototype.h=function(){Qr.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Xr="closure_listenable_"+(1e6*Math.random()|0),Jr=0;function Zr(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ia=r,this.key=++Jr,this.ca=this.fa=!1}function es(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function ts(e){this.src=e,this.g={},this.h=0}function ns(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],s=mr(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(es(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function is(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==i)return r}return-1}ts.prototype.add=function(e,t,n,i,r){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=is(e,t,i,r);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new Zr(t,this.src,s,!!i,r)).fa=n,e.push(t)),t};var rs="closure_lm_"+(1e6*Math.random()|0),ss={};function os(e,t,n,i,r){if(i&&i.once)return cs(e,t,n,i,r);if(Array.isArray(t)){for(var s=0;s<t.length;s++)os(e,t[s],n,i,r);return null}return n=ms(n),e&&e[Xr]?e.N(t,n,sr(i)?!!i.capture:!!i,r):as(e,t,n,!1,i,r)}function as(e,t,n,i,r,s){if(!t)throw Error("Invalid event type");var o=sr(r)?!!r.capture:!!r,a=fs(e);if(a||(e[rs]=a=new ts(e)),(n=a.add(t,n,i,o,s)).proxy)return n;if(i=function(){var e=ds;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)Gr||(r=o),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(hs(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function cs(e,t,n,i,r){if(Array.isArray(t)){for(var s=0;s<t.length;s++)cs(e,t[s],n,i,r);return null}return n=ms(n),e&&e[Xr]?e.O(t,n,sr(i)?!!i.capture:!!i,r):as(e,t,n,!0,i,r)}function us(e,t,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)us(e,t[s],n,i,r);else i=sr(i)?!!i.capture:!!i,n=ms(n),e&&e[Xr]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=is(s=e.g[t],n,i,r))&&(es(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=fs(e))&&(t=e.g[t.toString()],e=-1,t&&(e=is(t,n,i,r)),(n=-1<e?t[e]:null)&&ls(n))}function ls(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[Xr])ns(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(hs(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=fs(t))?(ns(n,e),0==n.h&&(n.src=null,t[rs]=null)):es(e)}}}function hs(e){return e in ss?ss[e]:ss[e]="on"+e}function ds(e,t){if(e.ca)e=!0;else{t=new Qr(t,this);var n=e.listener,i=e.ia||e.src;e.fa&&ls(e),e=n.call(i,t)}return e}function fs(e){return(e=e[rs])instanceof ts?e:null}var ps="__closure_events_fn_"+(1e9*Math.random()>>>0);function ms(e){return"function"==typeof e?e:(e[ps]||(e[ps]=function(t){return e.handleEvent(t)}),e[ps])}function gs(){fr.call(this),this.i=new ts(this),this.P=this,this.I=null}function ys(e,t){var n,i=e.I;if(i)for(n=[];i;i=i.I)n.push(i);if(e=e.P,i=t.type||t,"string"==typeof t)t=new Wr(t,e);else if(t instanceof Wr)t.target=t.target||e;else{var r=t;Nr(t=new Wr(i,e),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];r=vs(o,i,!0,t)&&r}if(r=vs(o=t.g=e,i,!0,t)&&r,r=vs(o,i,!1,t)&&r,n)for(s=0;s<n.length;s++)r=vs(o=t.g=n[s],i,!1,t)&&r}function vs(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&ns(e.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}dr(gs,fr),gs.prototype[Xr]=!0,gs.prototype.removeEventListener=function(e,t,n,i){us(this,e,t,n,i)},gs.prototype.M=function(){if(gs.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)es(n[i]);delete t.g[e],t.h--}}this.I=null},gs.prototype.N=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},gs.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};var ws=nr.JSON.stringify;function bs(){var e=Cs;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Is,Ts=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new _s),(e=>e.reset()));class _s{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Es(e){nr.setTimeout((()=>{throw e}),0)}function Ss(e,t){Is||function(){var e=nr.Promise.resolve(void 0);Is=function(){e.then(As)}}(),ks||(Is(),ks=!0),Cs.add(e,t)}var ks=!1,Cs=new class{constructor(){this.h=this.g=null}add(e,t){const n=Ts.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function As(){for(var e;e=bs();){try{e.h.call(e.g)}catch(e){Es(e)}var t=Ts;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}ks=!1}function Ns(e,t){gs.call(this),this.h=e||1,this.g=t||nr,this.j=lr(this.kb,this),this.l=Date.now()}function Rs(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function Ds(e,t,n){if("function"==typeof e)n&&(e=lr(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=lr(e.handleEvent,e)}return 2147483647<Number(t)?-1:nr.setTimeout(e,t||0)}function Os(e){e.g=Ds((()=>{e.g=null,e.i&&(e.i=!1,Os(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}dr(Ns,gs),(Ji=Ns.prototype).da=!1,Ji.S=null,Ji.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),ys(this,"tick"),this.da&&(Rs(this),this.start()))}},Ji.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ji.M=function(){Ns.Z.M.call(this),Rs(this),delete this.g};class Ls extends fr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Os(this)}M(){super.M(),this.g&&(nr.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xs(e){fr.call(this),this.h=e,this.g={}}dr(xs,fr);var Ps=[];function Ms(e,t,n,i){Array.isArray(n)||(n&&(Ps[0]=n.toString()),n=Ps);for(var r=0;r<n.length;r++){var s=os(t,n[r],i||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Us(e){kr(e.g,(function(e,t){this.g.hasOwnProperty(t)&&ls(e)}),e),e.g={}}function Fs(){this.g=!0}function Vs(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return ws(n)}catch(e){return t}}(e,n)+(i?" "+i:"")}))}xs.prototype.M=function(){xs.Z.M.call(this),Us(this)},xs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Fs.prototype.Aa=function(){this.g=!1},Fs.prototype.info=function(){};var qs={},js=null;function Bs(){return js=js||new gs}function $s(e){Wr.call(this,qs.Ma,e)}function Hs(e){const t=Bs();ys(t,new $s(t,e))}function zs(e,t){Wr.call(this,qs.STAT_EVENT,e),this.stat=t}function Ks(e){const t=Bs();ys(t,new zs(t,e))}function Gs(e,t){Wr.call(this,qs.Na,e),this.size=t}function Ws(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return nr.setTimeout((function(){e()}),t)}qs.Ma="serverreachability",dr($s,Wr),qs.STAT_EVENT="statevent",dr(zs,Wr),qs.Na="timingevent",dr(Gs,Wr);var Qs={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Ys={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Xs(){}function Js(e){return e.h||(e.h=e.i())}function Zs(){}Xs.prototype.h=null;var eo,to={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function no(){Wr.call(this,"d")}function io(){Wr.call(this,"c")}function ro(){}function so(e,t,n,i){this.l=e,this.j=t,this.m=n,this.X=i||1,this.V=new xs(this),this.P=ao,e=Mr?125:void 0,this.W=new Ns(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new oo}function oo(){this.i=null,this.g="",this.h=!1}dr(no,Wr),dr(io,Wr),dr(ro,Xs),ro.prototype.g=function(){return new XMLHttpRequest},ro.prototype.i=function(){return{}},eo=new ro;var ao=45e3,co={},uo={};function lo(e,t,n){e.K=1,e.v=xo(Ao(t)),e.s=n,e.U=!0,ho(e,null)}function ho(e,t){e.F=Date.now(),go(e),e.A=Ao(e.v);var n=e.A,i=e.X;Array.isArray(i)||(i=[String(i)]),Go(n.h,"t",i),e.C=0,n=e.l.H,e.h=new oo,e.g=Ga(e.l,n?t:null,!e.s),0<e.O&&(e.L=new Ls(lr(e.Ia,e,e.g),e.O)),Ms(e.V,e.g,"readystatechange",e.gb),t=e.H?Cr(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Hs(1),function(e,t,n,i,r,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function fo(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function po(e,t,n){let i,r=!0;for(;!e.I&&e.C<n.length;){if(i=mo(e,n),i==uo){4==t&&(e.o=4,Ks(14),r=!1),Vs(e.j,e.m,null,"[Incomplete Response]");break}if(i==co){e.o=4,Ks(15),Vs(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}Vs(e.j,e.m,i,null),Io(e,i)}fo(e)&&i!=uo&&i!=co&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Ks(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Va(t),t.L=!0,Ks(11))):(Vs(e.j,e.m,n,"[Invalid Chunked Response]"),bo(e),wo(e))}function mo(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?uo:(n=Number(t.substring(n,i)),isNaN(n)?co:(i+=1)+n>t.length?uo:(t=t.substr(i,n),e.C=i+n,t))}function go(e){e.Y=Date.now()+e.P,yo(e,e.P)}function yo(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ws(lr(e.eb,e),t)}function vo(e){e.B&&(nr.clearTimeout(e.B),e.B=null)}function wo(e){0==e.l.G||e.I||Ba(e.l,e)}function bo(e){vo(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Rs(e.W),Us(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Io(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||Zo(n.i,e)))if(n.I=e.N,!e.J&&Zo(n.i,e)&&3==n.G){try{var i=n.Ca.g.parse(t)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;ja(n),Ra(n)}Fa(n),Ks(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&0==n.A&&!n.v&&(n.v=Ws(lr(n.ab,n),6e3));if(1>=Jo(n.i)&&n.ka){try{n.ka()}catch(e){}n.ka=void 0}}else Ha(n,11)}else if((e.J||n.g==e)&&ja(n),!wr(t))for(r=n.Ca.g.parse(t),t=0;t<r.length;t++){let u=r[t];if(n.U=u[0],u=u[1],2==n.G)if("c"==u[0]){n.J=u[1],n.la=u[2];const t=u[3];null!=t&&(n.ma=t,n.h.info("VER="+n.ma));const r=u[4];null!=r&&(n.za=r,n.h.info("SVER="+n.za));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(i=1.5*l,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=i.i;!s.g&&(Tr(e,"spdy")||Tr(e,"quic")||Tr(e,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(ea(s,s.h),s.h=null))}if(i.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.sa=e,Lo(i.F,i.D,e))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=e;if((i=n).oa=Ka(i,i.H?i.la:null,i.W),o.J){ta(i.i,o);var a=o,c=i.K;c&&a.setTimeout(c),a.B&&(vo(a),go(a)),i.g=o}else Ua(i);0<n.l.length&&La(n)}else"stop"!=u[0]&&"close"!=u[0]||Ha(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Ha(n,7):Na(n):"noop"!=u[0]&&n.j&&n.j.wa(u),n.A=0)}Hs(4)}catch(e){}}function To(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(rr(e)||"string"==typeof e)gr(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(rr(e)||"string"==typeof e){n=[];for(var i=e.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,e)n[i++]=r;i=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(rr(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length;for(var s=0;s<r;s++)t.call(void 0,i[s],n&&n[s],e)}}function _o(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(e)if(e instanceof _o)for(n=e.T(),i=0;i<n.length;i++)this.set(n[i],e.get(n[i]));else for(i in e)this.set(i,e[i])}function Eo(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var i=e.g[t];So(e.h,i)&&(e.g[n++]=i),t++}e.g.length=n}if(e.i!=e.g.length){var r={};for(n=t=0;t<e.g.length;)So(r,i=e.g[t])||(e.g[n++]=i,r[i]=1),t++;e.g.length=n}}function So(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(Ji=so.prototype).setTimeout=function(e){this.P=e},Ji.gb=function(e){e=e.target;const t=this.L;t&&3==Ea(e)?t.l():this.Ia(e)},Ji.Ia=function(e){try{if(e==this.g)e:{const l=Ea(this.g);var t=this.g.Da();const h=this.g.ba();if(!(3>l)&&(3!=l||Mr||this.g&&(this.h.h||this.g.ga()||Sa(this.g)))){this.I||4!=l||7==t||Hs(8==t||0>=h?3:2),vo(this);var n=this.g.ba();this.N=n;t:if(fo(this)){var i=Sa(this.g);e="";var r=i.length,s=4==Ea(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){bo(this),wo(this);var o="";break t}this.h.i=new nr.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:s&&t==r-1});i.splice(0,r),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(e,t,n,i,r,s,o){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,l,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!wr(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,Ks(12),bo(this),wo(this);break e}Vs(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Io(this,n)}this.U?(po(this,l,o),Mr&&this.i&&3==l&&(Ms(this.V,this.W,"tick",this.fb),this.W.start())):(Vs(this.j,this.m,o,null),Io(this,o)),4==l&&bo(this),this.i&&!this.I&&(4==l?Ba(this.l,this):(this.i=!1,go(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Ks(12)):(this.o=0,Ks(13)),bo(this),wo(this)}}}catch(e){}},Ji.fb=function(){if(this.g){var e=Ea(this.g),t=this.g.ga();this.C<t.length&&(vo(this),po(this,e,t),this.i&&4!=e&&go(this))}},Ji.cancel=function(){this.I=!0,bo(this)},Ji.eb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(Hs(3),Ks(17)),bo(this),this.o=2,wo(this)):yo(this,this.Y-e)},(Ji=_o.prototype).R=function(){Eo(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},Ji.T=function(){return Eo(this),this.g.concat()},Ji.get=function(e,t){return So(this.h,e)?this.h[e]:t},Ji.set=function(e,t){So(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},Ji.forEach=function(e,t){for(var n=this.T(),i=0;i<n.length;i++){var r=n[i],s=this.get(r);e.call(t,s,r,this)}};var ko=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Co(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof Co){this.g=void 0!==t?t:e.g,No(this,e.j),this.s=e.s,Ro(this,e.i),Do(this,e.m),this.l=e.l,t=e.h;var n=new $o;n.i=t.i,t.g&&(n.g=new _o(t.g),n.h=t.h),Oo(this,n),this.o=e.o}else e&&(n=String(e).match(ko))?(this.g=!!t,No(this,n[1]||"",!0),this.s=Po(n[2]||""),Ro(this,n[3]||"",!0),Do(this,n[4]),this.l=Po(n[5]||"",!0),Oo(this,n[6]||"",!0),this.o=Po(n[7]||"")):(this.g=!!t,this.h=new $o(null,this.g))}function Ao(e){return new Co(e)}function No(e,t,n){e.j=n?Po(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Ro(e,t,n){e.i=n?Po(t,!0):t}function Do(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Oo(e,t,n){t instanceof $o?(e.h=t,function(e,t){t&&!e.j&&(Ho(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(zo(this,t),Go(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=Mo(t,jo)),e.h=new $o(t,e.g))}function Lo(e,t,n){e.h.set(t,n)}function xo(e){return Lo(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Po(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Mo(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Uo),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Uo(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Co.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Mo(t,Fo,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Mo(t,Fo,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(Mo(n,"/"==n.charAt(0)?qo:Vo,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Mo(n,Bo)),e.join("")};var Fo=/[#\/\?@]/g,Vo=/[#\?:]/g,qo=/[#\?]/g,jo=/[#\?@]/g,Bo=/#/g;function $o(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Ho(e){e.g||(e.g=new _o,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var s=e[n].substring(0,i);r=e[n].substring(i+1)}else s=e[n];t(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function zo(e,t){Ho(e),t=Wo(e,t),So(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,So((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&Eo(e)))}function Ko(e,t){return Ho(e),t=Wo(e,t),So(e.g.h,t)}function Go(e,t,n){zo(e,t),0<n.length&&(e.i=null,e.g.set(Wo(e,t),vr(n)),e.h+=n.length)}function Wo(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Qo(e){this.l=e||Yo,e=nr.PerformanceNavigationTiming?0<(e=nr.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(nr.g&&nr.g.Ea&&nr.g.Ea()&&nr.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Ji=$o.prototype).add=function(e,t){Ho(this),this.i=null,e=Wo(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Ji.forEach=function(e,t){Ho(this),this.g.forEach((function(n,i){gr(n,(function(n){e.call(t,n,i,this)}),this)}),this)},Ji.T=function(){Ho(this);for(var e=this.g.R(),t=this.g.T(),n=[],i=0;i<t.length;i++)for(var r=e[i],s=0;s<r.length;s++)n.push(t[i]);return n},Ji.R=function(e){Ho(this);var t=[];if("string"==typeof e)Ko(this,e)&&(t=yr(t,this.g.get(Wo(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=yr(t,e[n])}return t},Ji.set=function(e,t){return Ho(this),this.i=null,Ko(this,e=Wo(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Ji.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},Ji.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var i=t[n],r=encodeURIComponent(String(i));i=this.R(i);for(var s=0;s<i.length;s++){var o=r;""!==i[s]&&(o+="="+encodeURIComponent(String(i[s]))),e.push(o)}}return this.i=e.join("&")};var Yo=10;function Xo(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Jo(e){return e.h?1:e.g?e.g.size:0}function Zo(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ea(e,t){e.g?e.g.add(t):e.h=t}function ta(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function na(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return vr(e.i)}function ia(){}function ra(){this.g=new ia}function sa(e,t,n){const i=n||"";try{To(e,(function(e,n){let r=e;sr(e)&&(r=ws(e)),t.push(i+n+"="+encodeURIComponent(r))}))}catch(e){throw t.push(i+"type="+encodeURIComponent("_badmap")),e}}function oa(e,t,n,i,r){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,r(i)}catch(e){}}function aa(e){this.l=e.$b||null,this.j=e.ib||!1}function ca(e,t){gs.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=ua,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Qo.prototype.cancel=function(){if(this.i=na(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},ia.prototype.stringify=function(e){return nr.JSON.stringify(e,void 0)},ia.prototype.parse=function(e){return nr.JSON.parse(e,void 0)},dr(aa,Xs),aa.prototype.g=function(){return new ca(this.l,this.j)},aa.prototype.i=function(e){return function(){return e}}({}),dr(ca,gs);var ua=0;function la(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function ha(e){e.readyState=4,e.l=null,e.j=null,e.A=null,da(e)}function da(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Ji=ca.prototype).open=function(e,t){if(this.readyState!=ua)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,da(this)},Ji.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||nr).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},Ji.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ha(this)),this.readyState=ua},Ji.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,da(this)),this.g&&(this.readyState=3,da(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==nr.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;la(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},Ji.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?ha(this):da(this),3==this.readyState&&la(this)}},Ji.Ua=function(e){this.g&&(this.response=this.responseText=e,ha(this))},Ji.Ta=function(e){this.g&&(this.response=e,ha(this))},Ji.ha=function(){this.g&&ha(this)},Ji.setRequestHeader=function(e,t){this.v.append(e,t)},Ji.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Ji.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var fa=nr.JSON.parse;function pa(e){gs.call(this),this.headers=new _o,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ma,this.K=this.L=!1}dr(pa,gs);var ma="",ga=/^https?$/i,ya=["POST","PUT"];function va(e){return"content-type"==e.toLowerCase()}function wa(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,ba(e),Ta(e)}function ba(e){e.D||(e.D=!0,ys(e,"complete"),ys(e,"error"))}function Ia(e){if(e.h&&void 0!==tr&&(!e.C[1]||4!=Ea(e)||2!=e.ba()))if(e.v&&4==Ea(e))Ds(e.Fa,0,e);else if(ys(e,"readystatechange"),4==Ea(e)){e.h=!1;try{const a=e.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===a){var r=String(e.H).match(ko)[1]||null;if(!r&&nr.self&&nr.self.location){var s=nr.self.location.protocol;r=s.substr(0,s.length-1)}i=!ga.test(r?r.toLowerCase():"")}n=i}if(n)ys(e,"complete"),ys(e,"success");else{e.m=6;try{var o=2<Ea(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.ba()+"]",ba(e)}}finally{Ta(e)}}}function Ta(e,t){if(e.g){_a(e);const n=e.g,i=e.C[0]?ir:null;e.g=null,e.C=null,t||ys(e,"ready");try{n.onreadystatechange=i}catch(e){}}}function _a(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(nr.clearTimeout(e.A),e.A=null)}function Ea(e){return e.g?e.g.readyState:0}function Sa(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case ma:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function ka(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=function(e){let t="";return kr(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Lo(e,t,n))}function Ca(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Aa(e){this.za=0,this.l=[],this.h=new Fs,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Ca("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Ca("baseRetryDelayMs",5e3,e),this.$a=Ca("retryDelaySeedMs",1e4,e),this.Ya=Ca("forwardChannelMaxRetries",2,e),this.ra=Ca("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new Qo(e&&e.concurrentRequestLimit),this.Ca=new ra,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function Na(e){if(Da(e),3==e.G){var t=e.V++,n=Ao(e.F);Lo(n,"SID",e.J),Lo(n,"RID",t),Lo(n,"TYPE","terminate"),Pa(e,n),(t=new so(e,e.h,t,void 0)).K=2,t.v=xo(Ao(n)),n=!1,nr.navigator&&nr.navigator.sendBeacon&&(n=nr.navigator.sendBeacon(t.v.toString(),"")),!n&&nr.Image&&((new Image).src=t.v,n=!0),n||(t.g=Ga(t.l,null),t.g.ea(t.v)),t.F=Date.now(),go(t)}za(e)}function Ra(e){e.g&&(Va(e),e.g.cancel(),e.g=null)}function Da(e){Ra(e),e.u&&(nr.clearTimeout(e.u),e.u=null),ja(e),e.i.cancel(),e.m&&("number"==typeof e.m&&nr.clearTimeout(e.m),e.m=null)}function Oa(e,t){e.l.push(new class{constructor(e,t){this.h=e,this.g=t}}(e.Za++,t)),3==e.G&&La(e)}function La(e){Xo(e.i)||e.m||(e.m=!0,Ss(e.Ha,e),e.C=0)}function xa(e,t){var n;n=t?t.m:e.V++;const i=Ao(e.F);Lo(i,"SID",e.J),Lo(i,"RID",n),Lo(i,"AID",e.U),Pa(e,i),e.o&&e.s&&ka(i,e.o,e.s),n=new so(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Ma(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),ea(e.i,n),lo(n,i,t)}function Pa(e,t){e.j&&To({},(function(e,n){Lo(t,n,e)}))}function Ma(e,t,n){n=Math.min(e.l.length,n);var i=e.j?lr(e.j.Oa,e.j,e):null;e:{var r=e.l;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=r[o].h;const a=r[o].g;if(n-=t,0>n)t=Math.max(0,r[o].h-100),s=!1;else try{sa(a,e,"req"+n+"_")}catch(e){i&&i(a)}}if(s){i=e.join("&");break e}}}return e=e.l.splice(0,n),t.D=e,i}function Ua(e){e.g||e.u||(e.Y=1,Ss(e.Ga,e),e.A=0)}function Fa(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=Ws(lr(e.Ga,e),$a(e,e.A)),e.A++,0))}function Va(e){null!=e.B&&(nr.clearTimeout(e.B),e.B=null)}function qa(e){e.g=new so(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=Ao(e.oa);Lo(t,"RID","rpc"),Lo(t,"SID",e.J),Lo(t,"CI",e.N?"0":"1"),Lo(t,"AID",e.U),Pa(e,t),Lo(t,"TYPE","xmlhttp"),e.o&&e.s&&ka(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=xo(Ao(t)),n.s=null,n.U=!0,ho(n,e)}function ja(e){null!=e.v&&(nr.clearTimeout(e.v),e.v=null)}function Ba(e,t){var n=null;if(e.g==t){ja(e),Va(e),e.g=null;var i=2}else{if(!Zo(e.i,t))return;n=t.D,ta(e.i,t),i=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==i){n=t.s?t.s.length:0,t=Date.now()-t.F;var r=e.C;ys(i=Bs(),new Gs(i,n,t,r)),La(e)}else Ua(e);else if(3==(r=t.o)||0==r&&0<e.I||!(1==i&&function(e,t){return!(Jo(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=Ws(lr(e.Ha,e,t),$a(e,e.C)),e.C++,0)))}(e,t)||2==i&&Fa(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),r){case 1:Ha(e,5);break;case 4:Ha(e,10);break;case 3:Ha(e,6);break;default:Ha(e,2)}}function $a(e,t){let n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function Ha(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var i=lr(e.jb,e);n||(n=new Co("//www.google.com/images/cleardot.gif"),nr.location&&"http"==nr.location.protocol||No(n,"https"),xo(n)),function(e,t){const n=new Fs;if(nr.Image){const i=new Image;i.onload=hr(oa,n,i,"TestLoadImage: loaded",!0,t),i.onerror=hr(oa,n,i,"TestLoadImage: error",!1,t),i.onabort=hr(oa,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=hr(oa,n,i,"TestLoadImage: timeout",!1,t),nr.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(n.toString(),i)}else Ks(2);e.G=0,e.j&&e.j.va(t),za(e),Da(e)}function za(e){e.G=0,e.I=-1,e.j&&(0==na(e.i).length&&0==e.l.length||(e.i.i.length=0,vr(e.l),e.l.length=0),e.j.ua())}function Ka(e,t,n){let i=function(e){return e instanceof Co?Ao(e):new Co(e,void 0)}(n);if(""!=i.i)t&&Ro(i,t+"."+i.i),Do(i,i.m);else{const e=nr.location;i=function(e,t,n,i){var r=new Co(null,void 0);return e&&No(r,e),t&&Ro(r,t),n&&Do(r,n),i&&(r.l=i),r}(e.protocol,t?t+"."+e.hostname:e.hostname,+e.port,n)}return e.aa&&kr(e.aa,(function(e,t){Lo(i,t,e)})),t=e.D,n=e.sa,t&&n&&Lo(i,t,n),Lo(i,"VER",e.ma),Pa(e,i),i}function Ga(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new pa(new aa({ib:!0})):new pa(e.qa)).L=e.H,t}function Wa(){}function Qa(){if(xr&&!(10<=Number(Kr)))throw Error("Environmental error: no available transport.")}function Ya(e,t){gs.call(this),this.g=new Aa(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!wr(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!wr(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new Za(this)}function Xa(e){no.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Ja(){io.call(this),this.status=1}function Za(e){this.g=e}(Ji=pa.prototype).ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():eo.g(),this.C=this.u?Js(this.u):Js(eo),this.g.onreadystatechange=lr(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void wa(this,e)}e=n||"";const r=new _o(this.headers);i&&To(i,(function(e,t){r.set(t,e)})),i=function(e){e:{var t=va;const n=e.length,i="string"==typeof e?e.split(""):e;for(let r=0;r<n;r++)if(r in i&&t.call(void 0,i[r],r,e)){t=r;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(r.T()),n=nr.FormData&&e instanceof nr.FormData,!(0<=mr(ya,t))||i||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{_a(this),0<this.B&&((this.K=function(e){return xr&&zr()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=lr(this.pa,this)):this.A=Ds(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){wa(this,e)}},Ji.pa=function(){void 0!==tr&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ys(this,"timeout"),this.abort(8))},Ji.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,ys(this,"complete"),ys(this,"abort"),Ta(this))},Ji.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ta(this,!0)),pa.Z.M.call(this)},Ji.Fa=function(){this.s||(this.F||this.v||this.l?Ia(this):this.cb())},Ji.cb=function(){Ia(this)},Ji.ba=function(){try{return 2<Ea(this)?this.g.status:-1}catch(e){return-1}},Ji.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},Ji.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),fa(t)}},Ji.Da=function(){return this.m},Ji.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ji=Aa.prototype).ma=8,Ji.G=1,Ji.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(e){}},Ji.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const r=new so(this,this.h,e,void 0);let s=this.s;if(this.P&&(s?(s=Cr(s),Nr(s,this.P)):s=this.P),null===this.o&&(r.H=s),this.ja)e:{for(var t=0,n=0;n<this.l.length;n++){var i=this.l[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.l.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Ma(this,r,t),Lo(n=Ao(this.F),"RID",e),Lo(n,"CVER",22),this.D&&Lo(n,"X-HTTP-Session-Id",this.D),Pa(this,n),this.o&&s&&ka(n,this.o,s),ea(this.i,r),this.Ra&&Lo(n,"TYPE","init"),this.ja?(Lo(n,"$req",t),Lo(n,"SID","null"),r.$=!0,lo(r,n,null)):lo(r,n,t),this.G=2}}else 3==this.G&&(e?xa(this,e):0==this.l.length||Xo(this.i)||xa(this))},Ji.Ga=function(){if(this.u=null,qa(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=Ws(lr(this.bb,this),e)}},Ji.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ks(10),Ra(this),qa(this))},Ji.ab=function(){null!=this.v&&(this.v=null,Ra(this),Fa(this),Ks(19))},Ji.jb=function(e){e?(this.h.info("Successfully pinged google.com"),Ks(2)):(this.h.info("Failed to ping google.com"),Ks(1))},(Ji=Wa.prototype).xa=function(){},Ji.wa=function(){},Ji.va=function(){},Ji.ua=function(){},Ji.Oa=function(){},Qa.prototype.g=function(e,t){return new Ya(e,t)},dr(Ya,gs),Ya.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Ss(lr(e.hb,e,t))),Ks(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=Ka(e,null,e.W),La(e)},Ya.prototype.close=function(){Na(this.g)},Ya.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,Oa(this.g,t)}else this.v?((t={}).__data__=ws(e),Oa(this.g,t)):Oa(this.g,e)},Ya.prototype.M=function(){this.g.j=null,delete this.j,Na(this.g),delete this.g,Ya.Z.M.call(this)},dr(Xa,no),dr(Ja,io),dr(Za,Wa),Za.prototype.xa=function(){ys(this.g,"a")},Za.prototype.wa=function(e){ys(this.g,new Xa(e))},Za.prototype.va=function(e){ys(this.g,new Ja(e))},Za.prototype.ua=function(){ys(this.g,"b")},Qa.prototype.createWebChannel=Qa.prototype.g,Ya.prototype.send=Ya.prototype.u,Ya.prototype.open=Ya.prototype.m,Ya.prototype.close=Ya.prototype.close,Qs.NO_ERROR=0,Qs.TIMEOUT=8,Qs.HTTP_ERROR=6,Ys.COMPLETE="complete",Zs.EventType=to,to.OPEN="a",to.CLOSE="b",to.ERROR="c",to.MESSAGE="d",gs.prototype.listen=gs.prototype.N,pa.prototype.listenOnce=pa.prototype.O,pa.prototype.getLastError=pa.prototype.La,pa.prototype.getLastErrorCode=pa.prototype.Da,pa.prototype.getStatus=pa.prototype.ba,pa.prototype.getResponseJson=pa.prototype.Qa,pa.prototype.getResponseText=pa.prototype.ga,pa.prototype.send=pa.prototype.ea;var ec=er.createWebChannelTransport=function(){return new Qa},tc=er.getStatEventTarget=function(){return Bs()},nc=er.ErrorCode=Qs,ic=er.EventType=Ys,rc=er.Event=qs,sc=er.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},oc=er.FetchXmlHttpFactory=aa,ac=er.WebChannel=Zs,cc=er.XhrIo=pa;const uc="@firebase/firestore";class lc{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}lc.UNAUTHENTICATED=new lc(null),lc.GOOGLE_CREDENTIALS=new lc("google-credentials-uid"),lc.FIRST_PARTY=new lc("first-party-uid"),lc.MOCK_USER=new lc("mock-user");let hc="9.9.4";const dc=new P("@firebase/firestore");function fc(){return dc.logLevel}function pc(e,...t){if(dc.logLevel<=N.DEBUG){const n=t.map(yc);dc.debug(`Firestore (${hc}): ${e}`,...n)}}function mc(e,...t){if(dc.logLevel<=N.ERROR){const n=t.map(yc);dc.error(`Firestore (${hc}): ${e}`,...n)}}function gc(e,...t){if(dc.logLevel<=N.WARN){const n=t.map(yc);dc.warn(`Firestore (${hc}): ${e}`,...n)}}function yc(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function vc(e="Unexpected state"){const t=`FIRESTORE (${hc}) INTERNAL ASSERTION FAILED: `+e;throw mc(t),new Error(t)}function wc(e,t){e||vc()}function bc(e,t){return e}const Ic={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Tc extends d{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _c{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Ec{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Sc{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(lc.UNAUTHENTICATED)))}shutdown(){}}class kc{constructor(e){this.t=e,this.currentUser=lc.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new _c;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new _c,e.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const t=r;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},o=e=>{pc("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(pc("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new _c)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(pc("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(wc("string"==typeof t.accessToken),new Ec(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return wc(null===e||"string"==typeof e),new lc(e)}}class Cc{constructor(e,t,n,i){this.h=e,this.l=t,this.m=n,this.g=i,this.type="FirstParty",this.user=lc.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(wc(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Ac{constructor(e,t,n,i){this.h=e,this.l=t,this.m=n,this.g=i}getToken(){return Promise.resolve(new Cc(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable((()=>t(lc.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Nc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Rc{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const n=e=>{null!=e.error&&pc("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.A;return this.A=e.token,pc("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{pc("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.T.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.T.getImmediate({optional:!0});e?i(e):pc("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(wc("string"==typeof e.token),this.A=e.token,new Nc(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Dc(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class Oc{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=Dc(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<t&&(n+=e.charAt(i[r]%e.length))}return n}}function Lc(e,t){return e<t?-1:e>t?1:0}function xc(e,t,n){return e.length===t.length&&e.every(((e,i)=>n(e,t[i])))}class Pc{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Tc(Ic.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Tc(Ic.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Tc(Ic.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Tc(Ic.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Pc.fromMillis(Date.now())}static fromDate(e){return Pc.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Pc(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Lc(this.nanoseconds,e.nanoseconds):Lc(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Mc{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Mc(e)}static min(){return new Mc(new Pc(0,0))}static max(){return new Mc(new Pc(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Uc{constructor(e,t,n){void 0===t?t=0:t>e.length&&vc(),void 0===n?n=e.length-t:n>e.length-t&&vc(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Uc.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Uc?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Fc extends Uc{construct(e,t,n){return new Fc(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Tc(Ic.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new Fc(t)}static emptyPath(){return new Fc([])}}const Vc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qc extends Uc{construct(e,t,n){return new qc(e,t,n)}static isValidIdentifier(e){return Vc.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qc.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new qc(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Tc(Ic.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new Tc(Ic.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Tc(Ic.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(s=!s,i++):"."!==t||s?(n+=t,i++):(r(),i++)}if(r(),s)throw new Tc(Ic.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qc(t)}static emptyPath(){return new qc([])}}class jc{constructor(e){this.path=e}static fromPath(e){return new jc(Fc.fromString(e))}static fromName(e){return new jc(Fc.fromString(e).popFirst(5))}static empty(){return new jc(Fc.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Fc.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Fc.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new jc(new Fc(e.slice()))}}function Bc(e){return new $c(e.readTime,e.key,-1)}class $c{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new $c(Mc.min(),jc.empty(),-1)}static max(){return new $c(Mc.max(),jc.empty(),-1)}}function Hc(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=jc.comparator(e.documentKey,t.documentKey),0!==n?n:Lc(e.largestBatchId,t.largestBatchId))}async function zc(e){if(e.code!==Ic.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;pc("LocalStore","Unexpectedly lost primary lease")}class Kc{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&vc(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Kc(((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Kc?t:Kc.resolve(t)}catch(e){return Kc.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Kc.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Kc.reject(t)}static resolve(e){return new Kc(((t,n)=>{t(e)}))}static reject(e){return new Kc(((t,n)=>{n(e)}))}static waitFor(e){return new Kc(((t,n)=>{let i=0,r=0,s=!1;e.forEach((e=>{++i,e.next((()=>{++r,s&&r===i&&t()}),(e=>n(e)))})),s=!0,r===i&&t()}))}static or(e){let t=Kc.resolve(!1);for(const n of e)t=t.next((e=>e?Kc.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,i)=>{n.push(t.call(this,e,i))})),this.waitFor(n)}static mapArray(e,t){return new Kc(((n,i)=>{const r=e.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===r&&n(s)}),(e=>i(e)))}}))}static doWhile(e,t){return new Kc(((n,i)=>{const r=()=>{!0===e()?t().next((()=>{r()}),i):n()};r()}))}}function Gc(e){return"IndexedDbTransactionError"===e.name}class Wc{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ut(e),this.ct=e=>t.writeSequenceNumber(e))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}function Qc(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Yc(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Xc(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}Wc.at=-1;class Jc{constructor(e,t){this.comparator=e,this.root=t||eu.EMPTY}insert(e,t){return new Jc(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,eu.BLACK,null,null))}remove(e){return new Jc(this.comparator,this.root.remove(e,this.comparator).copy(null,null,eu.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zc(this.root,e,this.comparator,!0)}}class Zc{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class eu{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:eu.RED,this.left=null!=i?i:eu.EMPTY,this.right=null!=r?r:eu.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new eu(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return eu.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return eu.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,eu.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,eu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw vc();if(this.right.isRed())throw vc();const e=this.left.check();if(e!==this.right.check())throw vc();return e+(this.isRed()?0:1)}}eu.EMPTY=null,eu.RED=!0,eu.BLACK=!1,eu.EMPTY=new class{constructor(){this.size=0}get key(){throw vc()}get value(){throw vc()}get color(){throw vc()}get left(){throw vc()}get right(){throw vc()}copy(e,t,n,i,r){return this}insert(e,t,n){return new eu(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class tu{constructor(e){this.comparator=e,this.data=new Jc(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nu(this.data.getIterator())}getIteratorFrom(e){return new nu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof tu))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new tu(this.comparator);return t.data=e,t}}class nu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class iu{constructor(e){this.fields=e,e.sort(qc.comparator)}static empty(){return new iu([])}unionWith(e){let t=new tu(qc.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new iu(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return xc(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class ru{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new ru(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ru(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Lc(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ru.EMPTY_BYTE_STRING=new ru("");const su=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ou(e){if(wc(!!e),"string"==typeof e){let t=0;const n=su.exec(e);if(wc(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:au(e.seconds),nanos:au(e.nanos)}}function au(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function cu(e){return"string"==typeof e?ru.fromBase64String(e):ru.fromUint8Array(e)}function uu(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function lu(e){const t=e.mapValue.fields.__previous_value__;return uu(t)?lu(t):t}function hu(e){const t=ou(e.mapValue.fields.__local_write_time__.timestampValue);return new Pc(t.seconds,t.nanos)}class du{constructor(e,t,n,i,r,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class fu{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new fu("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof fu&&e.projectId===this.projectId&&e.database===this.database}}function pu(e){return null==e}function mu(e){return 0===e&&1/e==-1/0}const gu={fields:{__type__:{stringValue:"__max__"}}};function yu(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?uu(e)?4:Du(e)?9007199254740991:10:vc()}function vu(e,t){if(e===t)return!0;const n=yu(e);if(n!==yu(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return hu(e).isEqual(hu(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ou(e.timestampValue),i=ou(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return cu(e.bytesValue).isEqual(cu(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return au(e.geoPointValue.latitude)===au(t.geoPointValue.latitude)&&au(e.geoPointValue.longitude)===au(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return au(e.integerValue)===au(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=au(e.doubleValue),i=au(t.doubleValue);return n===i?mu(n)===mu(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return xc(e.arrayValue.values||[],t.arrayValue.values||[],vu);case 10:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(Qc(n)!==Qc(i))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===i[e]||!vu(n[e],i[e])))return!1;return!0}(e,t);default:return vc()}}function wu(e,t){return void 0!==(e.values||[]).find((e=>vu(e,t)))}function bu(e,t){if(e===t)return 0;const n=yu(e),i=yu(t);if(n!==i)return Lc(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Lc(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=au(e.integerValue||e.doubleValue),i=au(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return Iu(e.timestampValue,t.timestampValue);case 4:return Iu(hu(e),hu(t));case 5:return Lc(e.stringValue,t.stringValue);case 6:return function(e,t){const n=cu(e),i=cu(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let e=0;e<n.length&&e<i.length;e++){const t=Lc(n[e],i[e]);if(0!==t)return t}return Lc(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Lc(au(e.latitude),au(t.latitude));return 0!==n?n:Lc(au(e.longitude),au(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],i=t.values||[];for(let e=0;e<n.length&&e<i.length;++e){const t=bu(n[e],i[e]);if(t)return t}return Lc(n.length,i.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===gu&&t===gu)return 0;if(e===gu)return 1;if(t===gu)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let e=0;e<i.length&&e<s.length;++e){const t=Lc(i[e],s[e]);if(0!==t)return t;const o=bu(n[i[e]],r[s[e]]);if(0!==o)return o}return Lc(i.length,s.length)}(e.mapValue,t.mapValue);default:throw vc()}}function Iu(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Lc(e,t);const n=ou(e),i=ou(t),r=Lc(n.seconds,i.seconds);return 0!==r?r:Lc(n.nanos,i.nanos)}function Tu(e){return _u(e)}function _u(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ou(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?cu(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,jc.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=_u(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+=`${r}:${_u(e.fields[r])}`;return n+"}"}(e.mapValue):vc();var t,n}function Eu(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Su(e){return!!e&&"integerValue"in e}function ku(e){return!!e&&"arrayValue"in e}function Cu(e){return!!e&&"nullValue"in e}function Au(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Nu(e){return!!e&&"mapValue"in e}function Ru(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Yc(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Ru(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ru(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Du(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Ou{constructor(e){this.value=e}static empty(){return new Ou({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Nu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ru(t)}setAll(e){let t=qc.emptyPath(),n={},i=[];e.forEach(((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=Ru(e):i.push(r.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());Nu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return vu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Nu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Yc(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Ou(Ru(this.value))}}function Lu(e){const t=[];return Yc(e.fields,((e,n)=>{const i=new qc([e]);if(Nu(n)){const e=Lu(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)})),new iu(t)}class xu{constructor(e,t,n,i,r,s){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.data=r,this.documentState=s}static newInvalidDocument(e){return new xu(e,0,Mc.min(),Mc.min(),Ou.empty(),0)}static newFoundDocument(e,t,n){return new xu(e,1,t,Mc.min(),n,0)}static newNoDocument(e,t){return new xu(e,2,t,Mc.min(),Ou.empty(),0)}static newUnknownDocument(e,t){return new xu(e,3,t,Mc.min(),Ou.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ou.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ou.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Mc.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof xu&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xu(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Pu{constructor(e,t=null,n=[],i=[],r=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ht=null}}function Mu(e,t=null,n=[],i=[],r=null,s=null,o=null){return new Pu(e,t,n,i,r,s,o)}function Uu(e){const t=bc(e);if(null===t.ht){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>{return(t=e).field.canonicalString()+t.op.toString()+Tu(t.value);var t})).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),pu(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Tu(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Tu(e))).join(",")),t.ht=e}return t.ht}function Fu(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Xu(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(n=e.filters[r],i=t.filters[r],n.op!==i.op||!n.field.isEqual(i.field)||!vu(n.value,i.value))return!1;var n,i;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Zu(e.startAt,t.startAt)&&Zu(e.endAt,t.endAt)}function Vu(e){return jc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class qu extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,n):new ju(e,t,n):"array-contains"===t?new zu(e,n):"in"===t?new Ku(e,n):"not-in"===t?new Gu(e,n):"array-contains-any"===t?new Wu(e,n):new qu(e,t,n)}static lt(e,t,n){return"in"===t?new Bu(e,n):new $u(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(bu(t,this.value)):null!==t&&yu(this.value)===yu(t)&&this.ft(bu(t,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return vc()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class ju extends qu{constructor(e,t,n){super(e,t,n),this.key=jc.fromName(n.referenceValue)}matches(e){const t=jc.comparator(e.key,this.key);return this.ft(t)}}class Bu extends qu{constructor(e,t){super(e,"in",t),this.keys=Hu(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class $u extends qu{constructor(e,t){super(e,"not-in",t),this.keys=Hu(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Hu(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>jc.fromName(e.referenceValue)))}class zu extends qu{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ku(t)&&wu(t.arrayValue,this.value)}}class Ku extends qu{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&wu(this.value.arrayValue,t)}}class Gu extends qu{constructor(e,t){super(e,"not-in",t)}matches(e){if(wu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!wu(this.value.arrayValue,t)}}class Wu extends qu{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ku(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>wu(this.value.arrayValue,e)))}}class Qu{constructor(e,t){this.position=e,this.inclusive=t}}class Yu{constructor(e,t="asc"){this.field=e,this.dir=t}}function Xu(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Ju(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(i=s.field.isKeyField()?jc.comparator(jc.fromName(o.referenceValue),n.key):bu(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function Zu(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!vu(e.position[n],t.position[n]))return!1;return!0}class el{constructor(e,t=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this._t=null,this.wt=null,this.startAt,this.endAt}}function tl(e){return new el(e)}function nl(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function il(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function rl(e){for(const t of e.filters)if(t.dt())return t.field;return null}function sl(e){return null!==e.collectionGroup}function ol(e){const t=bc(e);if(null===t._t){t._t=[];const e=rl(t),n=il(t);if(null!==e&&null===n)e.isKeyField()||t._t.push(new Yu(e)),t._t.push(new Yu(qc.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t._t.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new Yu(qc.keyField(),e))}}}return t._t}function al(e){const t=bc(e);if(!t.wt)if("F"===t.limitType)t.wt=Mu(t.path,t.collectionGroup,ol(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of ol(t)){const t="desc"===n.dir?"asc":"desc";e.push(new Yu(n.field,t))}const n=t.endAt?new Qu(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Qu(t.startAt.position,t.startAt.inclusive):null;t.wt=Mu(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}return t.wt}function cl(e,t,n){return new el(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ul(e,t){return Fu(al(e),al(t))&&e.limitType===t.limitType}function ll(e){return`${Uu(al(e))}|lt:${e.limitType}`}function hl(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>{return`${(t=e).field.canonicalString()} ${t.op} ${Tu(t.value)}`;var t})).join(", ")}]`),pu(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Tu(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Tu(e))).join(",")),`Target(${t})`}(al(e))}; limitType=${e.limitType})`}function dl(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):jc.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=Ju(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,ol(e),t)||e.endAt&&!function(e,t,n){const i=Ju(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,ol(e),t))}(e,t)}function fl(e){return(t,n)=>{let i=!1;for(const r of ol(e)){const e=pl(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}function pl(e,t,n){const i=e.field.isKeyField()?jc.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?bu(i,r):vc()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return vc()}}function ml(e,t){if(e.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mu(t)?"-0":t}}function gl(e){return{integerValue:""+e}}function yl(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!mu(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?gl(t):ml(e,t)}class vl{constructor(){this._=void 0}}function wl(e,t,n){return e instanceof Tl?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof _l?El(e,t):e instanceof Sl?kl(e,t):function(e,t){const n=Il(e,t),i=Al(n)+Al(e.yt);return Su(n)&&Su(e.yt)?gl(i):ml(e.It,i)}(e,t)}function bl(e,t,n){return e instanceof _l?El(e,t):e instanceof Sl?kl(e,t):n}function Il(e,t){return e instanceof Cl?Su(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class Tl extends vl{}class _l extends vl{constructor(e){super(),this.elements=e}}function El(e,t){const n=Nl(t);for(const t of e.elements)n.some((e=>vu(e,t)))||n.push(t);return{arrayValue:{values:n}}}class Sl extends vl{constructor(e){super(),this.elements=e}}function kl(e,t){let n=Nl(t);for(const t of e.elements)n=n.filter((e=>!vu(e,t)));return{arrayValue:{values:n}}}class Cl extends vl{constructor(e,t){super(),this.It=e,this.yt=t}}function Al(e){return au(e.integerValue||e.doubleValue)}function Nl(e){return ku(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Rl{constructor(e,t){this.version=e,this.transformResults=t}}class Dl{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Dl}static exists(e){return new Dl(void 0,e)}static updateTime(e){return new Dl(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ol(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ll{}function xl(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Hl(e.key,Dl.none()):new Vl(e.key,e.data,Dl.none());{const n=e.data,i=Ou.empty();let r=new tu(qc.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new ql(e.key,i,new iu(r.toArray()),Dl.none())}}function Pl(e,t,n){e instanceof Vl?function(e,t,n){const i=e.value.clone(),r=Bl(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof ql?function(e,t,n){if(!Ol(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=Bl(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(jl(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Ml(e,t,n,i){return e instanceof Vl?function(e,t,n,i){if(!Ol(e.precondition,t))return n;const r=e.value.clone(),s=$l(e.fieldTransforms,i,t);return r.setAll(s),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof ql?function(e,t,n,i){if(!Ol(e.precondition,t))return n;const r=$l(e.fieldTransforms,i,t),s=t.data;return s.setAll(jl(e)),s.setAll(r),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,i):function(e,t,n){return Ol(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Ul(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),r=Il(i.transform,e||null);null!=r&&(null===n&&(n=Ou.empty()),n.set(i.field,r))}return n||null}function Fl(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&xc(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof _l&&t instanceof _l||e instanceof Sl&&t instanceof Sl?xc(e.elements,t.elements,vu):e instanceof Cl&&t instanceof Cl?vu(e.yt,t.yt):e instanceof Tl&&t instanceof Tl}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Vl extends Ll{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ql extends Ll{constructor(e,t,n,i,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function jl(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}})),t}function Bl(e,t,n){const i=new Map;wc(e.length===n.length);for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,bl(o,a,n[r]))}return i}function $l(e,t,n){const i=new Map;for(const r of e){const e=r.transform,s=n.data.field(r.field);i.set(r.field,wl(e,s,t))}return i}class Hl extends Ll{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zl extends Ll{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Kl{constructor(e){this.count=e}}var Gl,Wl;function Ql(e){if(void 0===e)return mc("GRPC error has no .code"),Ic.UNKNOWN;switch(e){case Gl.OK:return Ic.OK;case Gl.CANCELLED:return Ic.CANCELLED;case Gl.UNKNOWN:return Ic.UNKNOWN;case Gl.DEADLINE_EXCEEDED:return Ic.DEADLINE_EXCEEDED;case Gl.RESOURCE_EXHAUSTED:return Ic.RESOURCE_EXHAUSTED;case Gl.INTERNAL:return Ic.INTERNAL;case Gl.UNAVAILABLE:return Ic.UNAVAILABLE;case Gl.UNAUTHENTICATED:return Ic.UNAUTHENTICATED;case Gl.INVALID_ARGUMENT:return Ic.INVALID_ARGUMENT;case Gl.NOT_FOUND:return Ic.NOT_FOUND;case Gl.ALREADY_EXISTS:return Ic.ALREADY_EXISTS;case Gl.PERMISSION_DENIED:return Ic.PERMISSION_DENIED;case Gl.FAILED_PRECONDITION:return Ic.FAILED_PRECONDITION;case Gl.ABORTED:return Ic.ABORTED;case Gl.OUT_OF_RANGE:return Ic.OUT_OF_RANGE;case Gl.UNIMPLEMENTED:return Ic.UNIMPLEMENTED;case Gl.DATA_LOSS:return Ic.DATA_LOSS;default:return vc()}}(Wl=Gl||(Gl={}))[Wl.OK=0]="OK",Wl[Wl.CANCELLED=1]="CANCELLED",Wl[Wl.UNKNOWN=2]="UNKNOWN",Wl[Wl.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wl[Wl.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wl[Wl.NOT_FOUND=5]="NOT_FOUND",Wl[Wl.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wl[Wl.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wl[Wl.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wl[Wl.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wl[Wl.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wl[Wl.ABORTED=10]="ABORTED",Wl[Wl.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wl[Wl.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wl[Wl.INTERNAL=13]="INTERNAL",Wl[Wl.UNAVAILABLE=14]="UNAVAILABLE",Wl[Wl.DATA_LOSS=15]="DATA_LOSS";class Yl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,i]of n)if(this.equalsFn(t,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],e))return void(i[n]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Yc(this.inner,((t,n)=>{for(const[t,i]of n)e(t,i)}))}isEmpty(){return Xc(this.inner)}size(){return this.innerSize}}const Xl=new Jc(jc.comparator);function Jl(){return Xl}const Zl=new Jc(jc.comparator);function eh(...e){let t=Zl;for(const n of e)t=t.insert(n.key,n);return t}function th(e){let t=Zl;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function nh(){return rh()}function ih(){return rh()}function rh(){return new Yl((e=>e.toString()),((e,t)=>e.isEqual(t)))}const sh=new Jc(jc.comparator),oh=new tu(jc.comparator);function ah(...e){let t=oh;for(const n of e)t=t.add(n);return t}const ch=new tu(Lc);function uh(){return ch}class lh{constructor(e,t,n,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,hh.createSynthesizedTargetChangeForCurrentChange(e,t)),new lh(Mc.min(),n,uh(),Jl(),ah())}}class hh{constructor(e,t,n,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t){return new hh(ru.EMPTY_BYTE_STRING,t,ah(),ah(),ah())}}class dh{constructor(e,t,n,i){this.Tt=e,this.removedTargetIds=t,this.key=n,this.Et=i}}class fh{constructor(e,t){this.targetId=e,this.At=t}}class ph{constructor(e,t,n=ru.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class mh{constructor(){this.Rt=0,this.bt=vh(),this.Pt=ru.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=ah(),t=ah(),n=ah();return this.bt.forEach(((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:vc()}})),new hh(this.Pt,this.vt,e,t,n)}Nt(){this.Vt=!1,this.bt=vh()}kt(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}Mt(e){this.Vt=!0,this.bt=this.bt.remove(e)}Ot(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class gh{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=Jl(),this.qt=yh(),this.Kt=new tu(Lc)}Gt(e){for(const t of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(t,e.Et):this.jt(t,e.key,e.Et);for(const t of e.removedTargetIds)this.jt(t,e.key,e.Et)}Wt(e){this.forEachTarget(e,(t=>{const n=this.zt(t);switch(e.state){case 0:this.Ht(t)&&n.Ct(e.resumeToken);break;case 1:n.Ft(),n.St||n.Nt(),n.Ct(e.resumeToken);break;case 2:n.Ft(),n.St||this.removeTarget(t);break;case 3:this.Ht(t)&&(n.$t(),n.Ct(e.resumeToken));break;case 4:this.Ht(t)&&(this.Jt(t),n.Ct(e.resumeToken));break;default:vc()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach(((e,n)=>{this.Ht(n)&&t(n)}))}Yt(e){const t=e.targetId,n=e.At.count,i=this.Xt(t);if(i){const e=i.target;if(Vu(e))if(0===n){const n=new jc(e.path);this.jt(t,n,xu.newNoDocument(n,Mc.min()))}else wc(1===n);else this.Zt(t)!==n&&(this.Jt(t),this.Kt=this.Kt.add(t))}}te(e){const t=new Map;this.Lt.forEach(((n,i)=>{const r=this.Xt(i);if(r){if(n.current&&Vu(r.target)){const t=new jc(r.target.path);null!==this.Ut.get(t)||this.ee(i,t)||this.jt(i,t,xu.newNoDocument(t,e))}n.Dt&&(t.set(i,n.xt()),n.Nt())}}));let n=ah();this.qt.forEach(((e,t)=>{let i=!0;t.forEachWhile((e=>{const t=this.Xt(e);return!t||2===t.purpose||(i=!1,!1)})),i&&(n=n.add(e))})),this.Ut.forEach(((t,n)=>n.setReadTime(e)));const i=new lh(e,t,this.Kt,this.Ut,n);return this.Ut=Jl(),this.qt=yh(),this.Kt=new tu(Lc),i}Qt(e,t){if(!this.Ht(e))return;const n=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,n),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}jt(e,t,n){if(!this.Ht(e))return;const i=this.zt(e);this.ee(e,t)?i.kt(t,1):i.Mt(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),n&&(this.Ut=this.Ut.insert(t,n))}removeTarget(e){this.Lt.delete(e)}Zt(e){const t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.zt(e).Ot()}zt(e){let t=this.Lt.get(e);return t||(t=new mh,this.Lt.set(e,t)),t}ne(e){let t=this.qt.get(e);return t||(t=new tu(Lc),this.qt=this.qt.insert(e,t)),t}Ht(e){const t=null!==this.Xt(e);return t||pc("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new mh),this.Bt.getRemoteKeysForTarget(e).forEach((t=>{this.jt(e,t,null)}))}ee(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}function yh(){return new Jc(jc.comparator)}function vh(){return new Jc(jc.comparator)}const wh={asc:"ASCENDING",desc:"DESCENDING"},bh={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Ih{constructor(e,t){this.databaseId=e,this.gt=t}}function Th(e,t){return e.gt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function _h(e,t){return e.gt?t.toBase64():t.toUint8Array()}function Eh(e,t){return Th(e,t.toTimestamp())}function Sh(e){return wc(!!e),Mc.fromTimestamp(function(e){const t=ou(e);return new Pc(t.seconds,t.nanos)}(e))}function kh(e,t){return function(e){return new Fc(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Ch(e){const t=Fc.fromString(e);return wc(zh(t)),t}function Ah(e,t){return kh(e.databaseId,t.path)}function Nh(e,t){const n=Ch(t);if(n.get(1)!==e.databaseId.projectId)throw new Tc(Ic.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Tc(Ic.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new jc(Oh(n))}function Rh(e,t){return kh(e.databaseId,t)}function Dh(e){return new Fc(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Oh(e){return wc(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Lh(e,t,n){return{name:Ah(e,t),fields:n.value.mapValue.fields}}function xh(e,t){return{documents:[Rh(e,t.path)]}}function Ph(e,t){const n={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(n.parent=Rh(e,i),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Rh(e,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(e){if(0===e.length)return;const t=e.map((e=>function(e){if("=="===e.op){if(Au(e.value))return{unaryFilter:{field:qh(e.field),op:"IS_NAN"}};if(Cu(e.value))return{unaryFilter:{field:qh(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Au(e.value))return{unaryFilter:{field:qh(e.field),op:"IS_NOT_NAN"}};if(Cu(e.value))return{unaryFilter:{field:qh(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qh(e.field),op:Vh(e.op),value:e.value}}}(e)));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);r&&(n.structuredQuery.where=r);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:qh(e.field),direction:Fh(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(e,t){return e.gt||pu(t)?t:{value:t}}(e,t.limit);var a;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Mh(e){let t=function(e){const t=Ch(e);return 4===t.length?Fc.emptyPath():Oh(t)}(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){wc(1===i);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=Uh(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new Yu(jh(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,pu(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new Qu(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new Qu(n,t)}(n.endAt)),function(e,t,n,i,r,s,o,a){return new el(e,t,n,i,r,s,o,a)}(t,r,o,s,a,"F",c,u)}function Uh(e){return e?void 0!==e.unaryFilter?[$h(e)]:void 0!==e.fieldFilter?[Bh(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((e=>Uh(e))).reduce(((e,t)=>e.concat(t))):vc():[]}function Fh(e){return wh[e]}function Vh(e){return bh[e]}function qh(e){return{fieldPath:e.canonicalString()}}function jh(e){return qc.fromServerFormat(e.fieldPath)}function Bh(e){return qu.create(jh(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return vc()}}(e.fieldFilter.op),e.fieldFilter.value)}function $h(e){switch(e.unaryFilter.op){case"IS_NAN":const t=jh(e.unaryFilter.field);return qu.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=jh(e.unaryFilter.field);return qu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=jh(e.unaryFilter.field);return qu.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=jh(e.unaryFilter.field);return qu.create(r,"!=",{nullValue:"NULL_VALUE"});default:return vc()}}function Hh(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function zh(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Kh{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const i=this.mutations[t];i.key.isEqual(e.key)&&Pl(i,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ml(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ml(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=ih();return this.mutations.forEach((i=>{const r=e.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=t.has(i.key)?null:o;const a=xl(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(Mc.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ah())}isEqual(e){return this.batchId===e.batchId&&xc(this.mutations,e.mutations,((e,t)=>Fl(e,t)))&&xc(this.baseMutations,e.baseMutations,((e,t)=>Fl(e,t)))}}class Gh{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){wc(e.mutations.length===n.length);let i=sh;const r=e.mutations;for(let e=0;e<r.length;e++)i=i.insert(r[e].key,n[e].version);return new Gh(e,t,n,i)}}class Wh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Qh{constructor(e,t,n,i,r=Mc.min(),s=Mc.min(),o=ru.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new Qh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Qh(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Qh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Yh{constructor(e){this.re=e}}function Xh(e){const t=Mh({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?cl(t,t.limit,"L"):t}class Jh{constructor(){}ce(e,t){this.ae(e,t),t.he()}ae(e,t){if("nullValue"in e)this.le(t,5);else if("booleanValue"in e)this.le(t,10),t.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(t,15),t.fe(au(e.integerValue));else if("doubleValue"in e){const n=au(e.doubleValue);isNaN(n)?this.le(t,13):(this.le(t,15),mu(n)?t.fe(0):t.fe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.le(t,20),"string"==typeof n?t.de(n):(t.de(`${n.seconds||""}`),t.fe(n.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,t),this.we(t);else if("bytesValue"in e)this.le(t,30),t.me(cu(e.bytesValue)),this.we(t);else if("referenceValue"in e)this.ge(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.le(t,45),t.fe(n.latitude||0),t.fe(n.longitude||0)}else"mapValue"in e?Du(e)?this.le(t,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,t),this.we(t)):"arrayValue"in e?(this.pe(e.arrayValue,t),this.we(t)):vc()}_e(e,t){this.le(t,25),this.Ie(e,t)}Ie(e,t){t.de(e)}ye(e,t){const n=e.fields||{};this.le(t,55);for(const e of Object.keys(n))this._e(e,t),this.ae(n[e],t)}pe(e,t){const n=e.values||[];this.le(t,50);for(const e of n)this.ae(e,t)}ge(e,t){this.le(t,37),jc.fromName(e).path.forEach((e=>{this.le(t,60),this.Ie(e,t)}))}le(e,t){e.fe(t)}we(e){e.fe(2)}}Jh.Te=new Jh;class Zh{constructor(){this.Ye=new ed}addToCollectionParentIndex(e,t){return this.Ye.add(t),Kc.resolve()}getCollectionParents(e,t){return Kc.resolve(this.Ye.getEntries(t))}addFieldIndex(e,t){return Kc.resolve()}deleteFieldIndex(e,t){return Kc.resolve()}getDocumentsMatchingTarget(e,t){return Kc.resolve(null)}getIndexType(e,t){return Kc.resolve(0)}getFieldIndexes(e,t){return Kc.resolve([])}getNextCollectionGroupToUpdate(e){return Kc.resolve(null)}getMinOffset(e,t){return Kc.resolve($c.min())}getMinOffsetFromCollectionGroup(e,t){return Kc.resolve($c.min())}updateCollectionGroup(e,t,n){return Kc.resolve()}updateIndexEntries(e,t){return Kc.resolve()}}class ed{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new tu(Fc.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new tu(Fc.comparator)).toArray()}}new Uint8Array(0);class td{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new td(e,td.DEFAULT_COLLECTION_PERCENTILE,td.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}td.DEFAULT_COLLECTION_PERCENTILE=10,td.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,td.DEFAULT=new td(41943040,td.DEFAULT_COLLECTION_PERCENTILE,td.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),td.DISABLED=new td(-1,0,0);class nd{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new nd(0)}static vn(){return new nd(-1)}}class id{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class rd{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.getBaseDocument(e,t,n)))).next((e=>(null!==n&&Ml(n.mutation,e,iu.empty(),Pc.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,ah()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=ah()){const i=nh();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((e=>{let t=eh();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=nh();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,ah())))}populateOverlays(e,t,n){const i=[];return n.forEach((e=>{t.has(e)||i.push(e)})),this.documentOverlayCache.getOverlays(e,i).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,i){let r=Jl();const s=rh(),o=rh();return t.forEach(((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof ql)?r=r.insert(t.key,t):void 0!==o&&(s.set(t.key,o.mutation.getFieldMask()),Ml(o.mutation,t,o.mutation.getFieldMask(),Pc.now()))})),this.recalculateAndSaveOverlays(e,r).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new id(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=rh();let i=new Jc(((e,t)=>e-t)),r=ah();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const r of e)r.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||iu.empty();o=r.applyToLocalView(s,o),n.set(e,o);const a=(i.get(r.batchId)||ah()).add(e);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,u=ih();c.forEach((e=>{if(!r.has(e)){const i=xl(t.get(e),n.get(e));null!==i&&u.set(e,i),r=r.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return Kc.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return jc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):sl(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):Kc.resolve(nh());let o=-1,a=r;return s.next((t=>Kc.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(t)?Kc.resolve():this.getBaseDocument(e,t,n).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,r))).next((()=>this.computeViews(e,a,t,ah()))).next((e=>({batchId:o,changes:th(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new jc(t)).next((e=>{let t=eh();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let r=eh();return this.indexManager.getCollectionParents(e,i).next((s=>Kc.forEach(s,(s=>{const o=function(e,t){return new el(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n).next((e=>{e.forEach(((e,t)=>{r=r.insert(e,t)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((r=>(i=r,this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)))).next((e=>{e.forEach(((e,t)=>{const n=t.getKey();null===i.get(n)&&(i=i.insert(n,xu.newInvalidDocument(n)))}));let n=eh();return i.forEach(((i,r)=>{const s=e.get(i);void 0!==s&&Ml(s.mutation,r,iu.empty(),Pc.now()),dl(t,r)&&(n=n.insert(i,r))})),n}))}getBaseDocument(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):Kc.resolve(xu.newInvalidDocument(t))}}class sd{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return Kc.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var n;return this.Zn.set(t.id,{id:(n=t).id,version:n.version,createTime:Sh(n.createTime)}),Kc.resolve()}getNamedQuery(e,t){return Kc.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,function(e){return{name:e.name,query:Xh(e.bundledQuery),readTime:Sh(e.readTime)}}(t)),Kc.resolve()}}class od{constructor(){this.overlays=new Jc(jc.comparator),this.es=new Map}getOverlay(e,t){return Kc.resolve(this.overlays.get(t))}getOverlays(e,t){const n=nh();return Kc.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,i)=>{this.ue(e,t,i)})),Kc.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.es.get(n);return void 0!==i&&(i.forEach((e=>this.overlays=this.overlays.remove(e))),this.es.delete(n)),Kc.resolve()}getOverlaysForCollection(e,t,n){const i=nh(),r=t.length+1,s=new jc(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return Kc.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new Jc(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=nh(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=nh(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=i)););return Kc.resolve(o)}ue(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.es.get(i.largestBatchId).delete(n.key);this.es.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Wh(t,n));let r=this.es.get(t);void 0===r&&(r=ah(),this.es.set(t,r)),this.es.set(t,r.add(n.key))}}class ad{constructor(){this.ns=new tu(cd.ss),this.rs=new tu(cd.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const n=new cd(e,t);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.cs(new cd(e,t))}hs(e,t){e.forEach((e=>this.removeReference(e,t)))}ls(e){const t=new jc(new Fc([])),n=new cd(t,e),i=new cd(t,e+1),r=[];return this.rs.forEachInRange([n,i],(e=>{this.cs(e),r.push(e.key)})),r}fs(){this.ns.forEach((e=>this.cs(e)))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new jc(new Fc([])),n=new cd(t,e),i=new cd(t,e+1);let r=ah();return this.rs.forEachInRange([n,i],(e=>{r=r.add(e.key)})),r}containsKey(e){const t=new cd(e,0),n=this.ns.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class cd{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return jc.comparator(e.key,t.key)||Lc(e._s,t._s)}static os(e,t){return Lc(e._s,t._s)||jc.comparator(e.key,t.key)}}class ud{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new tu(cd.ss)}checkEmpty(e){return Kc.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Kh(r,t,n,i);this.mutationQueue.push(s);for(const t of i)this.gs=this.gs.add(new cd(t.key,r)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return Kc.resolve(s)}lookupMutationBatch(e,t){return Kc.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.ps(n),r=i<0?0:i;return Kc.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Kc.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return Kc.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new cd(t,0),i=new cd(t,Number.POSITIVE_INFINITY),r=[];return this.gs.forEachInRange([n,i],(e=>{const t=this.ys(e._s);r.push(t)})),Kc.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new tu(Lc);return t.forEach((e=>{const t=new cd(e,0),i=new cd(e,Number.POSITIVE_INFINITY);this.gs.forEachInRange([t,i],(e=>{n=n.add(e._s)}))})),Kc.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;jc.isDocumentKey(r)||(r=r.child(""));const s=new cd(new jc(r),0);let o=new tu(Lc);return this.gs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e._s)),!0)}),s),Kc.resolve(this.Is(o))}Is(e){const t=[];return e.forEach((e=>{const n=this.ys(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){wc(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return Kc.forEach(t.mutations,(i=>{const r=new cd(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.gs=n}))}An(e){}containsKey(e,t){const n=new cd(t,0),i=this.gs.firstAfterOrEqual(n);return Kc.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Kc.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ld{constructor(e){this.Es=e,this.docs=new Jc(jc.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,s=this.Es(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Kc.resolve(n?n.document.mutableCopy():xu.newInvalidDocument(t))}getEntries(e,t){let n=Jl();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():xu.newInvalidDocument(e))})),Kc.resolve(n)}getAllFromCollection(e,t,n){let i=Jl();const r=new jc(t.child("")),s=this.docs.getIteratorFrom(r);for(;s.hasNext();){const{key:e,value:{document:r}}=s.getNext();if(!t.isPrefixOf(e.path))break;e.path.length>t.length+1||Hc(Bc(r),n)<=0||(i=i.insert(r.key,r.mutableCopy()))}return Kc.resolve(i)}getAllFromCollectionGroup(e,t,n,i){vc()}As(e,t){return Kc.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new hd(this)}getSize(e){return Kc.resolve(this.size)}}class hd extends class{constructor(){this.changes=new Yl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xu.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Kc.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.Yn.addEntry(e,i)):this.Yn.removeEntry(n)})),Kc.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class dd{constructor(e){this.persistence=e,this.Rs=new Yl((e=>Uu(e)),Fu),this.lastRemoteSnapshotVersion=Mc.min(),this.highestTargetId=0,this.bs=0,this.Ps=new ad,this.targetCount=0,this.vs=nd.Pn()}forEachTarget(e,t){return this.Rs.forEach(((e,n)=>t(n))),Kc.resolve()}getLastRemoteSnapshotVersion(e){return Kc.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Kc.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),Kc.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),Kc.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new nd(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,Kc.resolve()}updateTargetData(e,t){return this.Dn(t),Kc.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,Kc.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.Rs.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Rs.delete(s),r.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),Kc.waitFor(r).next((()=>i))}getTargetCount(e){return Kc.resolve(this.targetCount)}getTargetData(e,t){const n=this.Rs.get(t)||null;return Kc.resolve(n)}addMatchingKeys(e,t,n){return this.Ps.us(t,n),Kc.resolve()}removeMatchingKeys(e,t,n){this.Ps.hs(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach((t=>{r.push(i.markPotentiallyOrphaned(e,t))})),Kc.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),Kc.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ps.ds(t);return Kc.resolve(n)}containsKey(e,t){return Kc.resolve(this.Ps.containsKey(t))}}class fd{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new Wc(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new dd(this),this.indexManager=new Zh,this.remoteDocumentCache=function(e){return new ld(e)}((e=>this.referenceDelegate.xs(e))),this.It=new Yh(t),this.Ns=new sd(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new od,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Vs[e.toKey()];return n||(n=new ud(t,this.referenceDelegate),this.Vs[e.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,n){pc("MemoryPersistence","Starting transaction:",e);const i=new pd(this.Ss.next());return this.referenceDelegate.ks(),n(i).next((e=>this.referenceDelegate.Ms(i).next((()=>e)))).toPromise().then((e=>(i.raiseOnCommittedEvent(),e)))}Os(e,t){return Kc.or(Object.values(this.Vs).map((n=>()=>n.containsKey(e,t))))}}class pd extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}{constructor(e){super(),this.currentSequenceNumber=e}}class md{constructor(e){this.persistence=e,this.Fs=new ad,this.$s=null}static Bs(e){return new md(e)}get Ls(){if(this.$s)return this.$s;throw vc()}addReference(e,t,n){return this.Fs.addReference(n,t),this.Ls.delete(n.toString()),Kc.resolve()}removeReference(e,t,n){return this.Fs.removeReference(n,t),this.Ls.add(n.toString()),Kc.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),Kc.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach((e=>this.Ls.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Ls.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}ks(){this.$s=new Set}Ms(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Kc.forEach(this.Ls,(n=>{const i=jc.fromPath(n);return this.Us(e,i).next((e=>{e||t.removeEntry(i,Mc.min())}))})).next((()=>(this.$s=null,t.apply(e))))}updateLimboDocument(e,t){return this.Us(e,t).next((e=>{e?this.Ls.delete(t.toString()):this.Ls.add(t.toString())}))}xs(e){return 0}Us(e,t){return Kc.or([()=>Kc.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Os(e,t)])}}class gd{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Si=n,this.Di=i}static Ci(e,t){let n=ah(),i=ah();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new gd(e,t.fromCache,n,i)}}class yd{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.ki(e,t).next((r=>r||this.Mi(e,t,i,n))).next((n=>n||this.Oi(e,t)))}ki(e,t){if(nl(t))return Kc.resolve(null);let n=al(t);return this.indexManager.getIndexType(e,n).next((i=>0===i?null:(null!==t.limit&&1===i&&(t=cl(t,null,"F"),n=al(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const r=ah(...i);return this.Ni.getDocuments(e,r).next((i=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Fi(t,i);return this.$i(t,s,r,n.readTime)?this.ki(e,cl(t,null,"F")):this.Bi(e,s,t,n)}))))})))))}Mi(e,t,n,i){return nl(t)||i.isEqual(Mc.min())?this.Oi(e,t):this.Ni.getDocuments(e,n).next((r=>{const s=this.Fi(t,r);return this.$i(t,s,n,i)?this.Oi(e,t):(fc()<=N.DEBUG&&pc("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),hl(t)),this.Bi(e,s,t,function(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=Mc.fromTimestamp(1e9===i?new Pc(n+1,0):new Pc(n,i));return new $c(r,jc.empty(),t)}(i,-1)))}))}Fi(e,t){let n=new tu(fl(e));return t.forEach(((t,i)=>{dl(e,i)&&(n=n.add(i))})),n}$i(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Oi(e,t){return fc()<=N.DEBUG&&pc("QueryEngine","Using full collection scan to execute query:",hl(t)),this.Ni.getDocumentsMatchingQuery(e,t,$c.min())}Bi(e,t,n,i){return this.Ni.getDocumentsMatchingQuery(e,n,i).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class vd{constructor(e,t,n,i){this.persistence=e,this.Li=t,this.It=i,this.Ui=new Jc(Lc),this.qi=new Yl((e=>Uu(e)),Fu),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(n)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rd(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ui)))}}async function wd(e,t){const n=bc(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next((r=>(i=r,n.Qi(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const r=[],s=[];let o=ah();for(const e of i){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({ji:e,removedBatchIds:r,addedBatchIds:s})))}))}))}function bd(e){const t=bc(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Cs.getLastRemoteSnapshotVersion(e)))}function Id(e,t){const n=bc(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}async function Td(e,t,n){const i=bc(e),r=i.Ui.get(t),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(e=>i.persistence.referenceDelegate.removeTarget(e,r)))}catch(e){if(!Gc(e))throw e;pc("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}i.Ui=i.Ui.remove(t),i.qi.delete(r.target)}function _d(e,t,n){const i=bc(e);let r=Mc.min(),s=ah();return i.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const i=bc(e),r=i.qi.get(n);return void 0!==r?Kc.resolve(i.Ui.get(r)):i.Cs.getTargetData(t,n)}(i,e,al(t)).next((t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,i.Cs.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>i.Li.getDocumentsMatchingQuery(e,t,n?r:Mc.min(),n?s:ah()))).next((e=>(function(e,t,n){let i=Mc.min();n.forEach(((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)})),e.Ki.set(t,i)}(i,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,Hi:s})))))}class Ed{constructor(){this.activeTargetIds=uh()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Sd{constructor(){this.Lr=new Ed,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,t,n){this.Ur[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new Ed,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class kd{qr(e){}shutdown(){}}class Cd{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){pc("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){pc("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Ad={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Nd{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class Rd extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.oo=t+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}co(e,t,n,i,r){const s=this.ao(e,t);pc("RestConnection","Sending: ",s,n);const o={};return this.ho(o,i,r),this.lo(e,s,o,n).then((e=>(pc("RestConnection","Received: ",e),e)),(t=>{throw gc("RestConnection",`${e} failed with error: `,t,"url: ",s,"request:",n),t}))}fo(e,t,n,i,r,s){return this.co(e,t,n,i,r)}ho(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+hc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}ao(e,t){const n=Ad[e];return`${this.oo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}lo(e,t,n,i){return new Promise(((r,s)=>{const o=new cc;o.listenOnce(ic.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case nc.NO_ERROR:const t=o.getResponseJson();pc("Connection","XHR received:",JSON.stringify(t)),r(t);break;case nc.TIMEOUT:pc("Connection",'RPC "'+e+'" timed out'),s(new Tc(Ic.DEADLINE_EXCEEDED,"Request time out"));break;case nc.HTTP_ERROR:const n=o.getStatus();if(pc("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Ic).indexOf(t)>=0?t:Ic.UNKNOWN}(e.status);s(new Tc(t,e.message))}else s(new Tc(Ic.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Tc(Ic.UNAVAILABLE,"Connection failed."));break;default:vc()}}finally{pc("Connection",'RPC "'+e+'" completed.')}}));const a=JSON.stringify(i);o.send(t,"POST",a,n,15)}))}_o(e,t,n){const i=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=ec(),l=tc(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new oc({})),this.ho(h.initMessageHeaders,t,n),o()||c()||s().indexOf("Electron/")>=0||u()||s().indexOf("MSAppHost/")>=0||a()||(h.httpHeadersOverwriteParam="$httpHeaders");const d=i.join("");pc("Connection","Creating WebChannel: "+d,h);const f=r.createWebChannel(d,h);let p=!1,m=!1;const g=new Nd({Hr:e=>{m?pc("Connection","Not sending because WebChannel is closed:",e):(p||(pc("Connection","Opening WebChannel transport."),f.open(),p=!0),pc("Connection","WebChannel sending:",e),f.send(e))},Jr:()=>f.close()}),y=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return y(f,ac.EventType.OPEN,(()=>{m||pc("Connection","WebChannel transport opened.")})),y(f,ac.EventType.CLOSE,(()=>{m||(m=!0,pc("Connection","WebChannel transport closed"),g.io())})),y(f,ac.EventType.ERROR,(e=>{m||(m=!0,gc("Connection","WebChannel transport errored:",e),g.io(new Tc(Ic.UNAVAILABLE,"The operation could not be completed")))})),y(f,ac.EventType.MESSAGE,(e=>{var t;if(!m){const n=e.data[0];wc(!!n);const i=n,r=i.error||(null===(t=i[0])||void 0===t?void 0:t.error);if(r){pc("Connection","WebChannel received error:",r);const e=r.status;let t=function(e){const t=Gl[e];if(void 0!==t)return Ql(t)}(e),n=r.message;void 0===t&&(t=Ic.INTERNAL,n="Unknown error status: "+e+" with message "+r.message),m=!0,g.io(new Tc(t,n)),f.close()}else pc("Connection","WebChannel received:",n),g.ro(n)}})),y(l,rc.STAT_EVENT,(e=>{e.stat===sc.PROXY?pc("Connection","Detected buffering proxy"):e.stat===sc.NOPROXY&&pc("Connection","Detected no buffering proxy")})),setTimeout((()=>{g.so()}),0),g}}function Dd(){return"undefined"!=typeof document?document:null}function Od(e){return new Ih(e,!0)}class Ld{constructor(e,t,n=1e3,i=1.5,r=6e4){this.Hs=e,this.timerId=t,this.wo=n,this.mo=i,this.yo=r,this.po=0,this.Io=null,this.To=Date.now(),this.reset()}reset(){this.po=0}Eo(){this.po=this.yo}Ao(e){this.cancel();const t=Math.floor(this.po+this.Ro()),n=Math.max(0,Date.now()-this.To),i=Math.max(0,t-n);i>0&&pc("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.po} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Io=this.Hs.enqueueAfterDelay(this.timerId,i,(()=>(this.To=Date.now(),e()))),this.po*=this.mo,this.po<this.wo&&(this.po=this.wo),this.po>this.yo&&(this.po=this.yo)}bo(){null!==this.Io&&(this.Io.skipDelay(),this.Io=null)}cancel(){null!==this.Io&&(this.Io.cancel(),this.Io=null)}Ro(){return(Math.random()-.5)*this.po}}class xd{constructor(e,t,n,i,r,s,o,a){this.Hs=e,this.Po=n,this.vo=i,this.Vo=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Ld(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Mo()}async stop(){this.No()&&await this.close(0)}Oo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.Po,6e4,(()=>this.$o())))}Bo(e){this.Lo(),this.stream.send(e)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(e,t){this.Lo(),this.Uo(),this.xo.cancel(),this.So++,4!==e?this.xo.reset():t&&t.code===Ic.RESOURCE_EXHAUSTED?(mc(t.toString()),mc("Using maximum backoff delay to prevent overloading the backend."),this.xo.Eo()):t&&t.code===Ic.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.qo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zr(t)}qo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.So===t&&this.Go(e,n)}),(t=>{e((()=>{const e=new Tc(Ic.UNKNOWN,"Fetching auth token failed: "+t.message);return this.Qo(e)}))}))}Go(e,t){const n=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr((()=>{n((()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.vo,1e4,(()=>(this.ko()&&(this.state=3),Promise.resolve()))),this.listener.Yr())))})),this.stream.Zr((e=>{n((()=>this.Qo(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Mo(){this.state=5,this.xo.Ao((async()=>{this.state=0,this.start()}))}Qo(e){return pc("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget((()=>this.So===e?t():(pc("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Pd extends xd{constructor(e,t,n,i,r,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,s),this.It=r}jo(e,t){return this.Vo._o("Listen",e,t)}onMessage(e){this.xo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:vc()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=function(e,t){return e.gt?(wc(void 0===t||"string"==typeof t),ru.fromBase64String(t||"")):(wc(void 0===t||t instanceof Uint8Array),ru.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Ic.UNKNOWN:Ql(e.code);return new Tc(t,e.message||"")}(o);n=new ph(i,r,s,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=Nh(e,i.document.name),s=Sh(i.document.updateTime),o=new Ou({mapValue:{fields:i.document.fields}}),a=xu.newFoundDocument(r,s,o),c=i.targetIds||[],u=i.removedTargetIds||[];n=new dh(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=Nh(e,i.document),s=i.readTime?Sh(i.readTime):Mc.min(),o=xu.newNoDocument(r,s),a=i.removedTargetIds||[];n=new dh([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=Nh(e,i.document),s=i.removedTargetIds||[];n=new dh([],s,r,null)}else{if(!("filter"in t))return vc();{t.filter;const e=t.filter;e.targetId;const i=e.count||0,r=new Kl(i),s=e.targetId;n=new fh(s,r)}}return n}(this.It,e),n=function(e){if(!("targetChange"in e))return Mc.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Mc.min():t.readTime?Sh(t.readTime):Mc.min()}(e);return this.listener.Wo(t,n)}zo(e){const t={};t.database=Dh(this.It),t.addTarget=function(e,t){let n;const i=t.target;return n=Vu(i)?{documents:xh(e,i)}:{query:Ph(e,i)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=_h(e,t.resumeToken):t.snapshotVersion.compareTo(Mc.min())>0&&(n.readTime=Th(e,t.snapshotVersion.toTimestamp())),n}(this.It,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return vc()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.It,e);n&&(t.labels=n),this.Bo(t)}Ho(e){const t={};t.database=Dh(this.It),t.removeTarget=e,this.Bo(t)}}class Md extends xd{constructor(e,t,n,i,r,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.It=r,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(e,t){return this.Vo._o("Write",e,t)}onMessage(e){if(wc(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=function(e,t){return e&&e.length>0?(wc(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Sh(e.updateTime):Sh(t);return n.isEqual(Mc.min())&&(n=Sh(t)),new Rl(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Sh(e.commitTime);return this.listener.Zo(n,t)}return wc(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=Dh(this.It),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>function(e,t){let n;if(t instanceof Vl)n={update:Lh(e,t.key,t.value)};else if(t instanceof Hl)n={delete:Ah(e,t.key)};else if(t instanceof ql)n={update:Lh(e,t.key,t.data),updateMask:Hh(t.fieldMask)};else{if(!(t instanceof zl))return vc();n={verify:Ah(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Tl)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof _l)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Sl)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Cl)return{fieldPath:t.field.canonicalString(),increment:n.yt};throw vc()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Eh(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:vc()}(e,t.precondition)),n}(this.It,e)))};this.Bo(t)}}class Ud extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.Vo=n,this.It=i,this.nu=!1}su(){if(this.nu)throw new Tc(Ic.FAILED_PRECONDITION,"The client has already been terminated.")}co(e,t,n){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.Vo.co(e,t,n,i,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ic.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Tc(Ic.UNKNOWN,e.toString())}))}fo(e,t,n,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.Vo.fo(e,t,n,r,s,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ic.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Tc(Ic.UNKNOWN,e.toString())}))}terminate(){this.nu=!0}}class Fd{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(mc(t),this.ou=!1):pc("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class Vd{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=r,this.mu.qr((e=>{n.enqueueAndForget((async()=>{Wd(this)&&(pc("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=bc(e);t._u.add(4),await jd(t),t.gu.set("Unknown"),t._u.delete(4),await qd(t)}(this))}))})),this.gu=new Fd(n,i)}}async function qd(e){if(Wd(e))for(const t of e.wu)await t(!0)}async function jd(e){for(const t of e.wu)await t(!1)}function Bd(e,t){const n=bc(e);n.du.has(t.targetId)||(n.du.set(t.targetId,t),Gd(n)?Kd(n):df(n).ko()&&Hd(n,t))}function $d(e,t){const n=bc(e),i=df(n);n.du.delete(t),i.ko()&&zd(n,t),0===n.du.size&&(i.ko()?i.Fo():Wd(n)&&n.gu.set("Unknown"))}function Hd(e,t){e.yu.Ot(t.targetId),df(e).zo(t)}function zd(e,t){e.yu.Ot(t),df(e).Ho(t)}function Kd(e){e.yu=new gh({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),se:t=>e.du.get(t)||null}),df(e).start(),e.gu.uu()}function Gd(e){return Wd(e)&&!df(e).No()&&e.du.size>0}function Wd(e){return 0===bc(e)._u.size}function Qd(e){e.yu=void 0}async function Yd(e){e.du.forEach(((t,n)=>{Hd(e,t)}))}async function Xd(e,t){Qd(e),Gd(e)?(e.gu.hu(t),Kd(e)):e.gu.set("Unknown")}async function Jd(e,t,n){if(e.gu.set("Online"),t instanceof ph&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const i of t.targetIds)e.du.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.du.delete(i),e.yu.removeTarget(i))}(e,t)}catch(n){pc("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Zd(e,n)}else if(t instanceof dh?e.yu.Gt(t):t instanceof fh?e.yu.Yt(t):e.yu.Wt(t),!n.isEqual(Mc.min()))try{const t=await bd(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.yu.te(t);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=e.du.get(i);r&&e.du.set(i,r.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((t=>{const n=e.du.get(t);if(!n)return;e.du.set(t,n.withResumeToken(ru.EMPTY_BYTE_STRING,n.snapshotVersion)),zd(e,t);const i=new Qh(n.target,t,1,n.sequenceNumber);Hd(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){pc("RemoteStore","Failed to raise snapshot:",t),await Zd(e,t)}}async function Zd(e,t,n){if(!Gc(t))throw t;e._u.add(1),await jd(e),e.gu.set("Offline"),n||(n=()=>bd(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{pc("RemoteStore","Retrying IndexedDB access"),await n(),e._u.delete(1),await qd(e)}))}function ef(e,t){return t().catch((n=>Zd(e,n,t)))}async function tf(e){const t=bc(e),n=ff(t);let i=t.fu.length>0?t.fu[t.fu.length-1].batchId:-1;for(;nf(t);)try{const e=await Id(t.localStore,i);if(null===e){0===t.fu.length&&n.Fo();break}i=e.batchId,rf(t,e)}catch(e){await Zd(t,e)}sf(t)&&of(t)}function nf(e){return Wd(e)&&e.fu.length<10}function rf(e,t){e.fu.push(t);const n=ff(e);n.ko()&&n.Yo&&n.Xo(t.mutations)}function sf(e){return Wd(e)&&!ff(e).No()&&e.fu.length>0}function of(e){ff(e).start()}async function af(e){ff(e).eu()}async function cf(e){const t=ff(e);for(const n of e.fu)t.Xo(n.mutations)}async function uf(e,t,n){const i=e.fu.shift(),r=Gh.from(i,t,n);await ef(e,(()=>e.remoteSyncer.applySuccessfulWrite(r))),await tf(e)}async function lf(e,t){t&&ff(e).Yo&&await async function(e,t){if(function(e){switch(e){default:return vc();case Ic.CANCELLED:case Ic.UNKNOWN:case Ic.DEADLINE_EXCEEDED:case Ic.RESOURCE_EXHAUSTED:case Ic.INTERNAL:case Ic.UNAVAILABLE:case Ic.UNAUTHENTICATED:return!1;case Ic.INVALID_ARGUMENT:case Ic.NOT_FOUND:case Ic.ALREADY_EXISTS:case Ic.PERMISSION_DENIED:case Ic.FAILED_PRECONDITION:case Ic.ABORTED:case Ic.OUT_OF_RANGE:case Ic.UNIMPLEMENTED:case Ic.DATA_LOSS:return!0}}(n=t.code)&&n!==Ic.ABORTED){const n=e.fu.shift();ff(e).Oo(),await ef(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await tf(e)}var n}(e,t),sf(e)&&of(e)}async function hf(e,t){const n=bc(e);n.asyncQueue.verifyOperationInProgress(),pc("RemoteStore","RemoteStore received new credentials");const i=Wd(n);n._u.add(3),await jd(n),i&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n._u.delete(3),await qd(n)}function df(e){return e.pu||(e.pu=function(e,t,n){const i=bc(e);return i.su(),new Pd(t,i.Vo,i.authCredentials,i.appCheckCredentials,i.It,n)}(e.datastore,e.asyncQueue,{Yr:Yd.bind(null,e),Zr:Xd.bind(null,e),Wo:Jd.bind(null,e)}),e.wu.push((async t=>{t?(e.pu.Oo(),Gd(e)?Kd(e):e.gu.set("Unknown")):(await e.pu.stop(),Qd(e))}))),e.pu}function ff(e){return e.Iu||(e.Iu=function(e,t,n){const i=bc(e);return i.su(),new Md(t,i.Vo,i.authCredentials,i.appCheckCredentials,i.It,n)}(e.datastore,e.asyncQueue,{Yr:af.bind(null,e),Zr:lf.bind(null,e),tu:cf.bind(null,e),Zo:uf.bind(null,e)}),e.wu.push((async t=>{t?(e.Iu.Oo(),await tf(e)):(await e.Iu.stop(),e.fu.length>0&&(pc("RemoteStore",`Stopping write stream with ${e.fu.length} pending writes`),e.fu=[]))}))),e.Iu}class pf{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new _c,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,i,r){const s=Date.now()+n,o=new pf(e,t,s,i,r);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Tc(Ic.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function mf(e,t){if(mc("AsyncQueue",`${t}: ${e}`),Gc(e))return new Tc(Ic.UNAVAILABLE,`${t}: ${e}`);throw e}class gf{constructor(e){this.comparator=e?(t,n)=>e(t,n)||jc.comparator(t.key,n.key):(e,t)=>jc.comparator(e.key,t.key),this.keyedMap=eh(),this.sortedSet=new Jc(this.comparator)}static emptySet(e){return new gf(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gf))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new gf;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class yf{constructor(){this.Tu=new Jc(jc.comparator)}track(e){const t=e.doc.key,n=this.Tu.get(t);n?0!==e.type&&3===n.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==n.type?this.Tu=this.Tu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Tu=this.Tu.remove(t):1===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):vc():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal(((t,n)=>{e.push(n)})),e}}class vf{constructor(e,t,n,i,r,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,i){const r=[];return t.forEach((e=>{r.push({type:0,doc:e})})),new vf(e,t,gf.emptySet(t),r,n,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ul(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class wf{constructor(){this.Au=void 0,this.listeners=[]}}class bf{constructor(){this.queries=new Yl((e=>ll(e)),ul),this.onlineState="Unknown",this.Ru=new Set}}async function If(e,t){const n=bc(e),i=t.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new wf),r)try{s.Au=await n.onListen(i)}catch(e){const n=mf(e,`Initialization of query '${hl(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.listeners.push(t),t.bu(n.onlineState),s.Au&&t.Pu(s.Au)&&Sf(n)}async function Tf(e,t){const n=bc(e),i=t.query;let r=!1;const s=n.queries.get(i);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),r=0===s.listeners.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}function _f(e,t){const n=bc(e);let i=!1;for(const e of t){const t=e.query,r=n.queries.get(t);if(r){for(const t of r.listeners)t.Pu(e)&&(i=!0);r.Au=e}}i&&Sf(n)}function Ef(e,t,n){const i=bc(e),r=i.queries.get(t);if(r)for(const e of r.listeners)e.onError(n);i.queries.delete(t)}function Sf(e){e.Ru.forEach((e=>{e.next()}))}class kf{constructor(e,t,n){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=n||{}}Pu(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new vf(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return!(this.options.Nu&&n||e.docs.isEmpty()&&"Offline"!==t)}Du(e){if(e.docChanges.length>0)return!0;const t=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}xu(e){e=vf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Vu=!0,this.vu.next(e)}}class Cf{constructor(e){this.key=e}}class Af{constructor(e){this.key=e}}class Nf{constructor(e,t){this.query=e,this.Lu=t,this.Uu=null,this.current=!1,this.qu=ah(),this.mutatedKeys=ah(),this.Ku=fl(e),this.Gu=new gf(this.Ku)}get Qu(){return this.Lu}ju(e,t){const n=t?t.Wu:new yf,i=t?t.Gu:this.Gu;let r=t?t.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((e,t)=>{const u=i.get(e),l=dl(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.zu(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.Ku(l,a)>0||c&&this.Ku(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),r=d?r.add(e):r.delete(e)):(s=s.delete(e),r=r.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),r=r.delete(e.key),n.track({type:1,doc:e})}return{Gu:s,Wu:n,$i:o,mutatedKeys:r}}zu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.Gu;this.Gu=e.Gu,this.mutatedKeys=e.mutatedKeys;const r=e.Wu.Eu();r.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return vc()}};return n(e)-n(t)}(e.type,t.type)||this.Ku(e.doc,t.doc))),this.Hu(n);const s=t?this.Ju():[],o=0===this.qu.size&&this.current?1:0,a=o!==this.Uu;return this.Uu=o,0!==r.length||a?{snapshot:new vf(this.query,e.Gu,i,r,e.mutatedKeys,0===o,a,!1),Yu:s}:{Yu:s}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Gu:this.Gu,Wu:new yf,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Yu:[]}}Xu(e){return!this.Lu.has(e)&&!!this.Gu.has(e)&&!this.Gu.get(e).hasLocalMutations}Hu(e){e&&(e.addedDocuments.forEach((e=>this.Lu=this.Lu.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Lu=this.Lu.delete(e))),this.current=e.current)}Ju(){if(!this.current)return[];const e=this.qu;this.qu=ah(),this.Gu.forEach((e=>{this.Xu(e.key)&&(this.qu=this.qu.add(e.key))}));const t=[];return e.forEach((e=>{this.qu.has(e)||t.push(new Af(e))})),this.qu.forEach((n=>{e.has(n)||t.push(new Cf(n))})),t}Zu(e){this.Lu=e.Hi,this.qu=ah();const t=this.ju(e.documents);return this.applyChanges(t,!0)}tc(){return vf.fromInitialDocuments(this.query,this.Gu,this.mutatedKeys,0===this.Uu)}}class Rf{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Df{constructor(e){this.key=e,this.ec=!1}}class Of{constructor(e,t,n,i,r,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.nc={},this.sc=new Yl((e=>ll(e)),ul),this.ic=new Map,this.rc=new Set,this.oc=new Jc(jc.comparator),this.uc=new Map,this.cc=new ad,this.ac={},this.hc=new Map,this.lc=nd.vn(),this.onlineState="Unknown",this.fc=void 0}get isPrimaryClient(){return!0===this.fc}}async function Lf(e,t){const n=function(e){const t=bc(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Pf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Qf.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Uf.bind(null,t),t.nc.Wo=_f.bind(null,t.eventManager),t.nc._c=Ef.bind(null,t.eventManager),t}(e);let i,r;const s=n.sc.get(t);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.tc();else{const e=await function(e,t){const n=bc(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let i;return n.Cs.getTargetData(e,t).next((r=>r?(i=r,Kc.resolve(i)):n.Cs.allocateTargetId(e).next((r=>(i=new Qh(t,r,0,e.currentSequenceNumber),n.Cs.addTargetData(e,i).next((()=>i)))))))})).then((e=>{const i=n.Ui.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(e.targetId,e),n.qi.set(t,e.targetId)),e}))}(n.localStore,al(t));n.isPrimaryClient&&Bd(n.remoteStore,e);const s=n.sharedClientState.addLocalQueryTarget(e.targetId);i=e.targetId,r=await async function(e,t,n,i){e.dc=(t,n,i)=>async function(e,t,n,i){let r=t.view.ju(n);r.$i&&(r=await _d(e.localStore,t.query,!1).then((({documents:e})=>t.view.ju(e,r))));const s=i&&i.targetChanges.get(t.targetId),o=t.view.applyChanges(r,e.isPrimaryClient,s);return Hf(e,t.targetId,o.Yu),o.snapshot}(e,t,n,i);const r=await _d(e.localStore,t,!0),s=new Nf(t,r.Hi),o=s.ju(r.documents),a=hh.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState),c=s.applyChanges(o,e.isPrimaryClient,a);Hf(e,n,c.Yu);const u=new Rf(t,n,s);return e.sc.set(t,u),e.ic.has(n)?e.ic.get(n).push(t):e.ic.set(n,[t]),c.snapshot}(n,t,i,"current"===s)}return r}async function xf(e,t){const n=bc(e),i=n.sc.get(t),r=n.ic.get(i.targetId);if(r.length>1)return n.ic.set(i.targetId,r.filter((e=>!ul(e,t)))),void n.sc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Td(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),$d(n.remoteStore,i.targetId),Bf(n,i.targetId)})).catch(zc)):(Bf(n,i.targetId),await Td(n.localStore,i.targetId,!0))}async function Pf(e,t){const n=bc(e);try{const e=await function(e,t){const n=bc(e),i=t.snapshotVersion;let r=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Gi.newChangeBuffer({trackRemovals:!0});r=n.Ui;const o=[];t.targetChanges.forEach(((s,a)=>{const c=r.get(a);if(!c)return;o.push(n.Cs.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Cs.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(a)?u=u.withResumeToken(ru.EMPTY_BYTE_STRING,Mc.min()).withLastLimboFreeSnapshotVersion(Mc.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,i)),r=r.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.Cs.updateTargetData(e,u))}));let a=Jl(),c=ah();if(t.documentUpdates.forEach((i=>{t.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))})),o.push(function(e,t,n){let i=ah(),r=ah();return n.forEach((e=>i=i.add(e))),t.getEntries(e,i).next((e=>{let i=Jl();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(Mc.min())?(t.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),i=i.insert(n,s)):pc("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{Wi:i,zi:r}}))}(e,s,t.documentUpdates).next((e=>{a=e.Wi,c=e.zi}))),!i.isEqual(Mc.min())){const t=n.Cs.getLastRemoteSnapshotVersion(e).next((t=>n.Cs.setTargetsMetadata(e,e.currentSequenceNumber,i)));o.push(t)}return Kc.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.Ui=r,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const i=n.uc.get(t);i&&(wc(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?i.ec=!0:e.modifiedDocuments.size>0?wc(i.ec):e.removedDocuments.size>0&&(wc(i.ec),i.ec=!1))})),await Gf(n,e,t)}catch(e){await zc(e)}}function Mf(e,t,n){const i=bc(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.sc.forEach(((n,i)=>{const r=i.view.bu(t);r.snapshot&&e.push(r.snapshot)})),function(e,t){const n=bc(e);n.onlineState=t;let i=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.bu(t)&&(i=!0)})),i&&Sf(n)}(i.eventManager,t),e.length&&i.nc.Wo(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Uf(e,t,n){const i=bc(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.uc.get(t),s=r&&r.key;if(s){let e=new Jc(jc.comparator);e=e.insert(s,xu.newNoDocument(s,Mc.min()));const n=ah().add(s),r=new lh(Mc.min(),new Map,new tu(Lc),e,n);await Pf(i,r),i.oc=i.oc.remove(s),i.uc.delete(t),Kf(i)}else await Td(i.localStore,t,!1).then((()=>Bf(i,t,n))).catch(zc)}async function Ff(e,t){const n=bc(e),i=t.batch.batchId;try{const e=await function(e,t){const n=bc(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const i=t.batch.keys(),r=n.Gi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const r=n.batch,s=r.keys();let o=Kc.resolve();return s.forEach((e=>{o=o.next((()=>i.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);wc(null!==s),t.version.compareTo(s)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,r)))}(n,e,t,r).next((()=>r.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=ah();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(n.localStore,t);jf(n,i,null),qf(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Gf(n,e)}catch(e){await zc(e)}}async function Vf(e,t,n){const i=bc(e);try{const e=await function(e,t){const n=bc(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(wc(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(i.localStore,t);jf(i,t,n),qf(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await Gf(i,e)}catch(n){await zc(n)}}function qf(e,t){(e.hc.get(t)||[]).forEach((e=>{e.resolve()})),e.hc.delete(t)}function jf(e,t,n){const i=bc(e);let r=i.ac[i.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),i.ac[i.currentUser.toKey()]=r}}function Bf(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.ic.get(t))e.sc.delete(i),n&&e.nc._c(i,n);e.ic.delete(t),e.isPrimaryClient&&e.cc.ls(t).forEach((t=>{e.cc.containsKey(t)||$f(e,t)}))}function $f(e,t){e.rc.delete(t.path.canonicalString());const n=e.oc.get(t);null!==n&&($d(e.remoteStore,n),e.oc=e.oc.remove(t),e.uc.delete(n),Kf(e))}function Hf(e,t,n){for(const i of n)i instanceof Cf?(e.cc.addReference(i.key,t),zf(e,i)):i instanceof Af?(pc("SyncEngine","Document no longer in limbo: "+i.key),e.cc.removeReference(i.key,t),e.cc.containsKey(i.key)||$f(e,i.key)):vc()}function zf(e,t){const n=t.key,i=n.path.canonicalString();e.oc.get(n)||e.rc.has(i)||(pc("SyncEngine","New document in limbo: "+n),e.rc.add(i),Kf(e))}function Kf(e){for(;e.rc.size>0&&e.oc.size<e.maxConcurrentLimboResolutions;){const t=e.rc.values().next().value;e.rc.delete(t);const n=new jc(Fc.fromString(t)),i=e.lc.next();e.uc.set(i,new Df(n)),e.oc=e.oc.insert(n,i),Bd(e.remoteStore,new Qh(al(tl(n.path)),i,2,Wc.at))}}async function Gf(e,t,n){const i=bc(e),r=[],s=[],o=[];i.sc.isEmpty()||(i.sc.forEach(((e,a)=>{o.push(i.dc(a,t,n).then((e=>{if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),r.push(e);const t=gd.Ci(a.targetId,e);s.push(t)}})))})),await Promise.all(o),i.nc.Wo(r),await async function(e,t){const n=bc(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Kc.forEach(t,(t=>Kc.forEach(t.Si,(i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i))).next((()=>Kc.forEach(t.Di,(i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))))))}catch(e){if(!Gc(e))throw e;pc("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ui.get(t),i=e.snapshotVersion,r=e.withLastLimboFreeSnapshotVersion(i);n.Ui=n.Ui.insert(t,r)}}}(i.localStore,s))}async function Wf(e,t){const n=bc(e);if(!n.currentUser.isEqual(t)){pc("SyncEngine","User change. New user:",t.toKey());const e=await wd(n.localStore,t);n.currentUser=t,function(e,t){e.hc.forEach((e=>{e.forEach((e=>{e.reject(new Tc(Ic.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.hc.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Gf(n,e.ji)}}function Qf(e,t){const n=bc(e),i=n.uc.get(t);if(i&&i.ec)return ah().add(i.key);{let e=ah();const i=n.ic.get(t);if(!i)return e;for(const t of i){const i=n.sc.get(t);e=e.unionWith(i.view.Qu)}return e}}function Yf(e){const t=bc(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Ff.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Vf.bind(null,t),t}class Xf{constructor(){this.synchronizeTabs=!1}async initialize(e){this.It=Od(e.databaseInfo.databaseId),this.sharedClientState=this.mc(e),this.persistence=this.gc(e),await this.persistence.start(),this.localStore=this.yc(e),this.gcScheduler=this.Ic(e,this.localStore),this.indexBackfillerScheduler=this.Tc(e,this.localStore)}Ic(e,t){return null}Tc(e,t){return null}yc(e){return function(e,t,n,i){return new vd(e,t,n,i)}(this.persistence,new yd,e.initialUser,this.It)}gc(e){return new fd(md.Bs,this.It)}mc(e){return new Sd}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Jf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Mf(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Wf.bind(null,this.syncEngine),await async function(e,t){const n=bc(e);t?(n._u.delete(2),await qd(n)):t||(n._u.add(2),await jd(n),n.gu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new bf}createDatastore(e){const t=Od(e.databaseInfo.databaseId),n=(i=e.databaseInfo,new Rd(i));var i;return function(e,t,n,i){return new Ud(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,r=e=>Mf(this.syncEngine,e,0),s=Cd.C()?new Cd:new kd,new Vd(t,n,i,r,s);var t,n,i,r,s}createSyncEngine(e,t){return function(e,t,n,i,r,s,o){const a=new Of(e,t,n,i,r,s);return o&&(a.fc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=bc(e);pc("RemoteStore","RemoteStore shutting down."),t._u.add(5),await jd(t),t.mu.shutdown(),t.gu.set("Unknown")}(this.remoteStore)}}class Zf{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ac(this.observer.next,e)}error(e){this.observer.error?this.Ac(this.observer.error,e):mc("Uncaught Error in snapshot listener:",e)}Rc(){this.muted=!0}Ac(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class ep{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=lc.UNAUTHENTICATED,this.clientId=Oc.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{pc("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(pc("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Tc(Ic.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _c;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=mf(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function tp(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){return e.offlineComponents||(pc("FirestoreClient","Using default OfflineComponentProvider"),await async function(e,t){e.asyncQueue.verifyOperationInProgress(),pc("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener((async e=>{i.isEqual(e)||(await wd(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e.offlineComponents=t}(e,new Xf)),e.offlineComponents}(e);pc("FirestoreClient","Initializing OnlineComponentProvider");const i=await e.getConfiguration();await t.initialize(n,i),e.setCredentialChangeListener((e=>hf(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>hf(t.remoteStore,n))),e.onlineComponents=t}async function np(e){return e.onlineComponents||(pc("FirestoreClient","Using default OnlineComponentProvider"),await tp(e,new Jf)),e.onlineComponents}async function ip(e){const t=await np(e),n=t.eventManager;return n.onListen=Lf.bind(null,t.syncEngine),n.onUnlisten=xf.bind(null,t.syncEngine),n}const rp=new Map;function sp(e,t,n){if(!n)throw new Tc(Ic.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function op(e){if(!jc.isDocumentKey(e))throw new Tc(Ic.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function ap(e){if(jc.isDocumentKey(e))throw new Tc(Ic.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function cp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":vc()}function up(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Tc(Ic.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=cp(e);throw new Tc(Ic.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class lp{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Tc(Ic.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Tc(Ic.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,i){if(!0===t&&!0===i)throw new Tc(Ic.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hp{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Tc(Ic.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Tc(Ic.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lp(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Sc;switch(e.type){case"gapi":const t=e.client;return new Ac(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Tc(Ic.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=rp.get(e);t&&(pc("ComponentProvider","Removing Datastore"),rp.delete(e),t.terminate())}(this),Promise.resolve()}}class dp{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pp(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new dp(this.firestore,e,this._key)}}class fp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new fp(this.firestore,e,this._query)}}class pp extends fp{constructor(e,t,n){super(e,t,tl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new dp(this.firestore,null,new jc(e))}withConverter(e){return new pp(this.firestore,e,this._path)}}function mp(e,t,...n){if(e=_(e),sp("collection","path",t),e instanceof hp){const i=Fc.fromString(t,...n);return ap(i),new pp(e,null,i)}{if(!(e instanceof dp||e instanceof pp))throw new Tc(Ic.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(Fc.fromString(t,...n));return ap(i),new pp(e.firestore,null,i)}}function gp(e,t,...n){if(e=_(e),1===arguments.length&&(t=Oc.R()),sp("doc","path",t),e instanceof hp){const i=Fc.fromString(t,...n);return op(i),new dp(e,null,new jc(i))}{if(!(e instanceof dp||e instanceof pp))throw new Tc(Ic.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(Fc.fromString(t,...n));return op(i),new dp(e.firestore,e instanceof pp?e.converter:null,new jc(i))}}class yp{constructor(){this.$c=Promise.resolve(),this.Bc=[],this.Lc=!1,this.Uc=[],this.qc=null,this.Kc=!1,this.Gc=!1,this.Qc=[],this.xo=new Ld(this,"async_queue_retry"),this.jc=()=>{const e=Dd();e&&pc("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.bo()};const e=Dd();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.jc)}get isShuttingDown(){return this.Lc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Wc(),this.zc(e)}enterRestrictedMode(e){if(!this.Lc){this.Lc=!0,this.Gc=e||!1;const t=Dd();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.jc)}}enqueue(e){if(this.Wc(),this.Lc)return new Promise((()=>{}));const t=new _c;return this.zc((()=>this.Lc&&this.Gc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Bc.push(e),this.Hc())))}async Hc(){if(0!==this.Bc.length){try{await this.Bc[0](),this.Bc.shift(),this.xo.reset()}catch(e){if(!Gc(e))throw e;pc("AsyncQueue","Operation failed with retryable error: "+e)}this.Bc.length>0&&this.xo.Ao((()=>this.Hc()))}}zc(e){const t=this.$c.then((()=>(this.Kc=!0,e().catch((e=>{this.qc=e,this.Kc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw mc("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Kc=!1,e))))));return this.$c=t,t}enqueueAfterDelay(e,t,n){this.Wc(),this.Qc.indexOf(e)>-1&&(t=0);const i=pf.createAndSchedule(this,e,t,n,(e=>this.Jc(e)));return this.Uc.push(i),i}Wc(){this.qc&&vc()}verifyOperationInProgress(){}async Yc(){let e;do{e=this.$c,await e}while(e!==this.$c)}Xc(e){for(const t of this.Uc)if(t.timerId===e)return!0;return!1}Zc(e){return this.Yc().then((()=>{this.Uc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Uc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Yc()}))}ta(e){this.Qc.push(e)}Jc(e){const t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}class vp extends hp{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new yp,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||bp(this),this._firestoreClient.terminate()}}function wp(e){return e._firestoreClient||bp(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function bp(e){var t;const n=e._freezeSettings(),i=function(e,t,n,i){return new du(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new ep(e._authCredentials,e._appCheckCredentials,e._queue,i)}class Ip{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Tc(Ic.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qc(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Tp{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Tp(ru.fromBase64String(e))}catch(e){throw new Tc(Ic.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Tp(ru.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class _p{constructor(e){this._methodName=e}}class Ep{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Tc(Ic.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Tc(Ic.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Lc(this._lat,e._lat)||Lc(this._long,e._long)}}const Sp=/^__.*__$/;class kp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new ql(e,this.data,this.fieldMask,t,this.fieldTransforms):new Vl(e,this.data,t,this.fieldTransforms)}}class Cp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ql(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Ap(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw vc()}}class Np{constructor(e,t,n,i,r,s){this.settings=e,this.databaseId=t,this.It=n,this.ignoreUndefinedProperties=i,void 0===r&&this.ea(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get na(){return this.settings.na}sa(e){return new Np(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ia(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.sa({path:n,ra:!1});return i.oa(e),i}ua(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.sa({path:n,ra:!1});return i.ea(),i}ca(e){return this.sa({path:void 0,ra:!0})}aa(e){return jp(e,this.settings.methodName,this.settings.ha||!1,this.path,this.settings.la)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}ea(){if(this.path)for(let e=0;e<this.path.length;e++)this.oa(this.path.get(e))}oa(e){if(0===e.length)throw this.aa("Document fields must not be empty");if(Ap(this.na)&&Sp.test(e))throw this.aa('Document fields cannot begin and end with "__"')}}class Rp{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.It=n||Od(e)}fa(e,t,n,i=!1){return new Np({na:e,methodName:t,la:n,path:qc.emptyPath(),ra:!1,ha:i},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Dp(e){const t=e._freezeSettings(),n=Od(e._databaseId);return new Rp(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Op(e,t,n,i,r,s={}){const o=e.fa(s.merge||s.mergeFields?2:0,t,n,r);Up("Data must be an object, but it was:",o,i);const a=Pp(i,o);let c,u;if(s.merge)c=new iu(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const i of s.mergeFields){const r=Fp(t,i,n);if(!o.contains(r))throw new Tc(Ic.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Bp(e,r)||e.push(r)}c=new iu(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new kp(new Ou(a),c,u)}class Lp extends _p{_toFieldTransform(e){if(2!==e.na)throw 1===e.na?e.aa(`${this._methodName}() can only appear at the top level of your update data`):e.aa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lp}}function xp(e,t){if(Mp(e=_(e)))return Up("Unsupported field value:",t,e),Pp(e,t);if(e instanceof _p)return function(e,t){if(!Ap(t.na))throw t.aa(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.aa(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.ra&&4!==t.na)throw t.aa("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const r of e){let e=xp(r,t.ca(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=_(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return yl(t.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Pc.fromDate(e);return{timestampValue:Th(t.It,n)}}if(e instanceof Pc){const n=new Pc(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Th(t.It,n)}}if(e instanceof Ep)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Tp)return{bytesValue:_h(t.It,e._byteString)};if(e instanceof dp){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t.aa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:kh(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.aa(`Unsupported field value: ${cp(e)}`)}(e,t)}function Pp(e,t){const n={};return Xc(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Yc(e,((e,i)=>{const r=xp(i,t.ia(e));null!=r&&(n[e]=r)})),{mapValue:{fields:n}}}function Mp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Pc||e instanceof Ep||e instanceof Tp||e instanceof dp||e instanceof _p)}function Up(e,t,n){if(!Mp(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const i=cp(n);throw"an object"===i?t.aa(e+" a custom object"):t.aa(e+" "+i)}}function Fp(e,t,n){if((t=_(t))instanceof Ip)return t._internalPath;if("string"==typeof t)return qp(e,t);throw jp("Field path arguments must be of type string or ",e,!1,void 0,n)}const Vp=new RegExp("[~\\*/\\[\\]]");function qp(e,t,n){if(t.search(Vp)>=0)throw jp(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Ip(...t.split("."))._internalPath}catch(i){throw jp(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function jp(e,t,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new Tc(Ic.INVALID_ARGUMENT,a+e+c)}function Bp(e,t){return e.some((e=>e.isEqual(t)))}class $p{constructor(e,t,n,i,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new dp(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Hp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(zp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Hp extends $p{data(){return super.data()}}function zp(e,t){return"string"==typeof t?qp(e,t):t instanceof Ip?t._internalPath:t._delegate._internalPath}class Kp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gp extends $p{constructor(e,t,n,i,r,s){super(e,t,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Wp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(zp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Wp extends Gp{data(e={}){return super.data(e)}}class Qp{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Kp(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Wp(this._firestore,this._userDataWriter,n.key,n,new Kp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Tc(Ic.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>({type:"added",doc:new Wp(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Kp(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++})))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const i=new Wp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Kp(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let r=-1,s=-1;return 0!==t.type&&(r=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Yp(t.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Yp(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return vc()}}function Xp(e,...t){for(const n of t)e=n._apply(e);return e}class Jp extends class{}{constructor(e,t,n){super(),this.wa=e,this.ma=t,this.ga=n,this.type="where"}_apply(e){const t=Dp(e.firestore),n=function(e,t,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Tc(Ic.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){em(o,s);const t=[];for(const n of o)t.push(Zp(i,e,n));a={arrayValue:{values:t}}}else a=Zp(i,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||em(o,s),a=function(e,t,n,i=!1){return xp(n,e.fa(i?4:3,t))}(n,"where",o,"in"===s||"not-in"===s);const c=qu.create(r,s,a);return function(e,t){if(t.dt()){const n=rl(e);if(null!==n&&!n.isEqual(t.field))throw new Tc(Ic.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${t.field.toString()}'`);const i=il(e);null!==i&&function(e,t,n){if(!n.isEqual(t))throw new Tc(Ic.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}(0,t.field,i)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Tc(Ic.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Tc(Ic.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}(e,c),c}(e._query,0,t,e.firestore._databaseId,this.wa,this.ma,this.ga);return new fp(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new el(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}function Zp(e,t,n){if("string"==typeof(n=_(n))){if(""===n)throw new Tc(Ic.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sl(t)&&-1!==n.indexOf("/"))throw new Tc(Ic.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(Fc.fromString(n));if(!jc.isDocumentKey(i))throw new Tc(Ic.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Eu(e,new jc(i))}if(n instanceof dp)return Eu(e,n._key);throw new Tc(Ic.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cp(n)}.`)}function em(e,t){if(!Array.isArray(e)||0===e.length)throw new Tc(Ic.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new Tc(Ic.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function tm(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}function nm(e){e=up(e,dp);const t=up(e.firestore,vp);return function(e,t,n={}){const i=new _c;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,r){const s=new Zf({next:s=>{t.enqueueAndForget((()=>Tf(e,o)));const a=s.docs.has(n);!a&&s.fromCache?r.reject(new Tc(Ic.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&i&&"server"===i.source?r.reject(new Tc(Ic.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(s)},error:e=>r.reject(e)}),o=new kf(tl(n.path),s,{includeMetadataChanges:!0,Nu:!0});return If(e,o)}(await ip(e),e.asyncQueue,t,n,i))),i.promise}(wp(t),e._key).then((n=>function(e,t,n){const i=n.docs.get(t._key),r=new im(e);return new Gp(e,r,t._key,i,new Kp(n.hasPendingWrites,n.fromCache),t.converter)}(t,e,n)))}class im extends class{convertValue(e,t="none"){switch(yu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return au(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(cu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw vc()}}convertObject(e,t){const n={};return Yc(e.fields,((e,i)=>{n[e]=this.convertValue(i,t)})),n}convertGeoPoint(e){return new Ep(au(e.latitude),au(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=lu(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(hu(e));default:return null}}convertTimestamp(e){const t=ou(e);return new Pc(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Fc.fromString(e);wc(zh(n));const i=new fu(n.get(1),n.get(3)),r=new jc(n.popFirst(5));return i.isEqual(t)||mc(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tp(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new dp(this.firestore,null,t)}}function rm(e){e=up(e,fp);const t=up(e.firestore,vp),n=wp(t),i=new im(t);return function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Tc(Ic.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query),function(e,t,n={}){const i=new _c;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,r){const s=new Zf({next:n=>{t.enqueueAndForget((()=>Tf(e,o))),n.fromCache&&"server"===i.source?r.reject(new Tc(Ic.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:e=>r.reject(e)}),o=new kf(n,s,{includeMetadataChanges:!0,Nu:!0});return If(e,o)}(await ip(e),e.asyncQueue,t,n,i))),i.promise}(n,e._query).then((n=>new Qp(t,i,e,n)))}function sm(e,t,n,...i){e=up(e,dp);const r=up(e.firestore,vp),s=Dp(r);let o;return o="string"==typeof(t=_(t))||t instanceof Ip?function(e,t,n,i,r,s){const o=e.fa(1,t,n),a=[Fp(t,i,n)],c=[r];if(s.length%2!=0)throw new Tc(Ic.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)a.push(Fp(t,s[e])),c.push(s[e+1]);const u=[],l=Ou.empty();for(let e=a.length-1;e>=0;--e)if(!Bp(u,a[e])){const t=a[e];let n=c[e];n=_(n);const i=o.ua(t);if(n instanceof Lp)u.push(t);else{const e=xp(n,i);null!=e&&(u.push(t),l.set(t,e))}}const h=new iu(u);return new Cp(l,h,o.fieldTransforms)}(s,"updateDoc",e._key,t,n,i):function(e,t,n,i){const r=e.fa(1,t,n);Up("Data must be an object, but it was:",r,i);const s=[],o=Ou.empty();Yc(i,((e,i)=>{const a=qp(t,e,n);i=_(i);const c=r.ua(a);if(i instanceof Lp)s.push(a);else{const e=xp(i,c);null!=e&&(s.push(a),o.set(a,e))}}));const a=new iu(s);return new Cp(o,a,r.fieldTransforms)}(s,"updateDoc",e._key,t),am(r,[o.toMutation(e._key,Dl.exists(!0))])}function om(e,t){const n=up(e.firestore,vp),i=gp(e),r=tm(e.converter,t);return am(n,[Op(Dp(e.firestore),"addDoc",i._key,r,null!==e.converter,{}).toMutation(i._key,Dl.exists(!1))]).then((()=>i))}function am(e,t){return function(e,t){const n=new _c;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const i=Yf(e);try{const e=await function(e,t){const n=bc(e),i=Pc.now(),r=t.reduce(((e,t)=>e.add(t.key)),ah());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Jl(),c=ah();return n.Gi.getEntries(e,r).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((r=>{s=r;const o=[];for(const e of t){const t=Ul(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new ql(e.key,t,Lu(t.value.mapValue),Dl.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,o,t)})).next((t=>{o=t;const i=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:th(s)})))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.ac[e.currentUser.toKey()];i||(i=new Jc(Lc)),i=i.insert(t,n),e.ac[e.currentUser.toKey()]=i}(i,e.batchId,n),await Gf(i,e.changes),await tf(i.remoteStore)}catch(e){const t=mf(e,"Failed to persist write");n.reject(t)}}(await function(e){return np(e).then((e=>e.syncEngine))}(e),t,n))),n.promise}(wp(e),t)}!function(e,t=!0){hc="9.9.4",ae(new E("firestore",((e,{instanceIdentifier:n,options:i})=>{const r=e.getProvider("app").getImmediate(),s=new vp(new kc(e.getProvider("auth-internal")),new Rc(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Tc(Ic.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fu(e.options.projectId,t)}(r,n),r);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),fe(uc,"3.4.15",e),fe(uc,"3.4.15","esm2017")}();const cm="firebasestorage.googleapis.com";class um extends d{constructor(e,t){super(lm(e),`Firebase Storage: ${t} (${lm(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,um.prototype)}_codeEquals(e){return lm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function lm(e){return"storage/"+e}function hm(){return new um("unknown","An unknown error occurred, please check the error payload for server response.")}function dm(e){return new um("invalid-argument",e)}function fm(){return new um("app-deleted","The Firebase app was deleted.")}function pm(e,t){return new um("invalid-format","String does not match format '"+e+"': "+t)}function mm(e){throw new um("internal-error","Internal error: "+e)}class gm{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=gm.makeFromUrl(e,t)}catch(t){return new gm(e,"")}if(""===n.path)return n;throw new um("invalid-default-bucket","Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)",r=new RegExp("^gs://"+i+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:r,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===cm?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let t=0;t<a.length;t++){const i=a[t],r=i.regex.exec(e);if(r){const e=r[i.indices.bucket];let t=r[i.indices.path];t||(t=""),n=new gm(e,t),i.postModify(n);break}}if(null==n)throw function(e){return new um("invalid-url","Invalid URL '"+e+"'.")}(e);return n}}class ym{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function vm(e){return"string"==typeof e||e instanceof String}function wm(e){return bm()&&e instanceof Blob}function bm(){return"undefined"!=typeof Blob}function Im(e,t,n,i){if(i<t)throw dm(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw dm(`Invalid value for '${e}'. Expected ${n} or less.`)}function Tm(e,t,n){let i=t;return null==n&&(i=`https://${t}`),`${n}://${i}/v0${e}`}function _m(e){const t=encodeURIComponent;let n="?";for(const i in e)e.hasOwnProperty(i)&&(n=n+(t(i)+"=")+t(e[i])+"&");return n=n.slice(0,-1),n}var Em;!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Em||(Em={}));class Sm{constructor(e,t,n,i,r,s,o,a,c,u,l){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=l,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{const n=this.resolve_,i=this.reject_,r=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(r,r.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(e){i(e)}else if(null!==r){const e=hm();e.serverResponse=r.getErrorText(),this.errorCallback_?i(this.errorCallback_(r,e)):i(e)}else t.canceled?i(this.appDelete_?fm():new um("canceled","User canceled the upload/download.")):i(new um("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))};this.canceled_?e(0,new km(!1,null,!0)):this.backoffId_=function(e,t,n){let i=1,r=null,s=null,o=!1,a=0;function c(){return 2===a}let u=!1;function l(...e){u||(u=!0,t.apply(null,e))}function h(t){r=setTimeout((()=>{r=null,e(f,c())}),t)}function d(){s&&clearTimeout(s)}function f(e,...t){if(u)return void d();if(e)return d(),void l.call(null,e,...t);if(c()||o)return d(),void l.call(null,e,...t);let n;i<64&&(i*=2),1===a?(a=2,n=0):n=1e3*(i+Math.random()),h(n)}let p=!1;function m(e){p||(p=!0,d(),u||(null!==r?(e||(a=2),clearTimeout(r),h(0)):e||(a=1)))}return h(0),s=setTimeout((()=>{o=!0,m(!0)}),n),m}(((e,t)=>{if(t)return void e(!1,new km(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const i=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(i),this.pendingConnection_=null;const t=n.getErrorCode()===Em.NO_ERROR,r=n.getStatus();if(!t||this.isRetryStatusCode_(r)){const t=n.getErrorCode()===Em.ABORT;return void e(!1,new km(!1,null,t))}const s=-1!==this.successCodes_.indexOf(r);e(!0,new km(s,n))}))}),e,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,n=-1!==[408,429].indexOf(e),i=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||i}}class km{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function Cm(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Am(...e){const t=Cm();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(bm())return new Blob(e);throw new um("unsupported-environment","This browser doesn't seem to support creating Blobs")}const Nm="base64",Rm="base64url",Dm="data_url";class Om{constructor(e,t){this.data=e,this.contentType=t||null}}function Lm(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<=127?t.push(i):i<=2047?t.push(192|i>>6,128|63&i):55296==(64512&i)?n<e.length-1&&56320==(64512&e.charCodeAt(n+1))?(i=65536|(1023&i)<<10|1023&e.charCodeAt(++n),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)):t.push(239,191,189):56320==(64512&i)?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(t)}function xm(e,t){switch(e){case Nm:{const n=-1!==t.indexOf("-"),i=-1!==t.indexOf("_");if(n||i)throw pm(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break}case Rm:{const n=-1!==t.indexOf("+"),i=-1!==t.indexOf("/");if(n||i)throw pm(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=atob(t)}catch(t){throw pm(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let e=0;e<n.length;e++)i[e]=n.charCodeAt(e);return i}class Pm{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw pm(Dm,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;var i,r;null!=n&&(this.base64=(r=";base64",(i=n).length>=r.length&&i.substring(i.length-r.length)===r),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}class Mm{constructor(e,t){let n=0,i="";wm(e)?(this.data_=e,n=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(wm(this.data_)){const s=(n=this.data_,i=e,r=t,n.webkitSlice?n.webkitSlice(i,r):n.mozSlice?n.mozSlice(i,r):n.slice?n.slice(i,r):null);return null===s?null:new Mm(s)}var n,i,r;{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Mm(n,!0)}}static getBlob(...e){if(bm()){const t=e.map((e=>e instanceof Mm?e.data_:e));return new Mm(Am.apply(null,t))}{const t=e.map((e=>vm(e)?function(e,t){switch(e){case"raw":return new Om(Lm(t));case Nm:case Rm:return new Om(xm(e,t));case Dm:return new Om(function(e){const t=new Pm(e);return t.base64?xm(Nm,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw pm(Dm,"Malformed data URL.")}return Lm(t)}(t.rest)}(t),new Pm(t).contentType)}throw hm()}("raw",e).data:e.data_));let n=0;t.forEach((e=>{n+=e.byteLength}));const i=new Uint8Array(n);let r=0;return t.forEach((e=>{for(let t=0;t<e.length;t++)i[r++]=e[t]})),new Mm(i,!0)}}uploadData(){return this.data_}}function Um(e){let t;try{t=JSON.parse(e)}catch(e){return null}return function(e){return"object"==typeof e&&!Array.isArray(e)}(t)?t:null}function Fm(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Vm(e,t){return t}class qm{constructor(e,t,n,i){this.server=e,this.local=t||e,this.writable=!!n,this.xform=i||Vm}}let jm=null;function Bm(){if(jm)return jm;const e=[];e.push(new qm("bucket")),e.push(new qm("generation")),e.push(new qm("metageneration")),e.push(new qm("name","fullPath",!0));const t=new qm("name");t.xform=function(e,t){return function(e){return!vm(e)||e.length<2?e:Fm(e)}(t)},e.push(t);const n=new qm("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new qm("timeCreated")),e.push(new qm("updated")),e.push(new qm("md5Hash",null,!0)),e.push(new qm("cacheControl",null,!0)),e.push(new qm("contentDisposition",null,!0)),e.push(new qm("contentEncoding",null,!0)),e.push(new qm("contentLanguage",null,!0)),e.push(new qm("contentType",null,!0)),e.push(new qm("metadata","customMetadata",!0)),jm=e,jm}function $m(e,t,n){const i=Um(t);return null===i?null:function(e,t,n){const i={type:"file"},r=n.length;for(let e=0;e<r;e++){const r=n[e];i[r.local]=r.xform(i,t[r.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,i=e.fullPath,r=new gm(n,i);return t._makeStorageReference(r)}})}(i,e),i}(e,i,n)}class Hm{constructor(e,t,n,i){this.url=e,this.method=t,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function zm(e){if(!e)throw hm()}function Km(e){return function(t,n){let i;var r,s;return 401===t.getStatus()?i=t.getErrorText().includes("Firebase App Check token is invalid")?new um("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new um("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,i=new um("quota-exceeded","Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(r=e.path,i=new um("unauthorized","User does not have permission to access '"+r+"'.")):i=n,i.serverResponse=n.serverResponse,i}}function Gm(e,t,n,i,r){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const c=function(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=function(e,t){return t&&t.type()||"application/octet-stream"}(0,t)),i}(t,i,r),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+function(e,t){const n={},i=t.length;for(let r=0;r<i;r++){const i=t[r];i.writable&&(n[i.server]=e[i.local])}return JSON.stringify(n)}(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=Mm.getBlob(u,i,l);if(null===h)throw new um("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.");const d={name:c.fullPath},f=Tm(s,e.host,e._protocol),p=e.maxUploadRetryTime,m=new Hm(f,"POST",function(e,t){return function(n,i){const r=$m(e,i,t);return zm(null!==r),r}}(e,n),p);return m.urlParams=d,m.headers=o,m.body=h.uploadData(),m.errorHandler=Km(t),m}class Wm extends class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Em.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=Em.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=Em.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,i){if(this.sent_)throw mm("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const e in i)i.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,i[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw mm("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw mm("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw mm("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw mm("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}{initXhr(){this.xhr_.responseType="text"}}function Qm(){return new Wm}class Ym{constructor(e,t){this._service=e,this._location=t instanceof gm?t:gm.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ym(e,t)}get root(){const e=new gm(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Fm(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new gm(this._location.bucket,e);return new Ym(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new um("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Xm(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const i=Tm(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,s=new Hm(i,"GET",function(e,t){return function(n,i){const r=$m(e,i,t);return zm(null!==r),function(e,t,n,i){const r=Um(t);if(null===r)return null;if(!vm(r.downloadTokens))return null;const s=r.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map((t=>{const r=e.bucket,s=e.fullPath;return Tm("/b/"+o(r)+"/o/"+o(s),n,i)+_m({alt:"media",token:t})}))[0]}(r,i,e.host,e._protocol)}}(e,n),r);return s.errorHandler=function(e){const t=Km(e);return function(n,i){let r=t(n,i);var s;return 404===n.getStatus()&&(s=e.path,r=new um("object-not-found","Object '"+s+"' does not exist.")),r.serverResponse=i.serverResponse,r}}(t),s}(e.storage,e._location,Bm());return e.storage.makeRequestWithTokens(t,Qm).then((e=>{if(null===e)throw new um("no-download-url","The given file does not have any download URLs.");return e}))}function Jm(e,t){if(e instanceof eg){const n=e;if(null==n._bucket)throw new um("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");const i=new Ym(n,n._bucket);return null!=t?Jm(i,t):i}return void 0!==t?function(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),i=new gm(e._location.bucket,n);return new Ym(e.storage,i)}(e,t):e}function Zm(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:gm.makeFromBucketSpec(n,e)}class eg{constructor(e,t,n,i,r){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=r,this._bucket=null,this._host=cm,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?gm.makeFromBucketSpec(i,this._host):Zm(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=gm.makeFromBucketSpec(this._url,e):this._bucket=Zm(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Im("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Im("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ym(this,e)}_makeRequest(e,t,n,i){if(this._deleted)return new ym(fm());{const r=function(e,t,n,i,r,s){const o=_m(e.urlParams),a=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,i),new Sm(a,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r)}(e,this._appId,n,i,t,this._firebaseVersion);return this._requests.add(r),r.getPromise().then((()=>this._requests.delete(r)),(()=>this._requests.delete(r))),r}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const tg="@firebase/storage",ng="0.9.9",ig="storage";function rg(e,t,n){return function(e,t,n){e._throwIfRoot("uploadBytes");const i=Gm(e.storage,e._location,Bm(),new Mm(t,!0),n);return e.storage.makeRequestWithTokens(i,Qm).then((t=>({metadata:t,ref:e})))}(e=_(e),t,n)}function sg(e){return Xm(e=_(e))}function og(e,t){return function(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof eg)return new Ym(e,t);throw dm("To use ref(service, url), the first argument must be a Storage instance.")}return Jm(e,t)}(e=_(e),t)}ae(new E(ig,(function(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return new eg(n,i,r,t,he)}),"PUBLIC").setMultipleInstances(!0)),fe(tg,ng,""),fe(tg,ng,"esm2017");const ag=function(e,t={}){"object"!=typeof t&&(t={name:t});const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},t),i=n.name;if("string"!=typeof i||!i)throw ue.create("bad-app-name",{appName:String(i)});const r=re.get(i);if(r){if(m(e,r.options)&&m(n,r.config))return r;throw ue.create("duplicate-app",{appName:i})}const s=new C(i);for(const e of se.values())s.addComponent(e);const o=new le(e,n,s);return re.set(i,o),o}({apiKey:"AIzaSyDWNIxpJ67KwsjbdkIT_gDf3w8PUJDNKyA",authDomain:"novellery-firebase.firebaseapp.com",projectId:"novellery-firebase",storageBucket:"novellery-firebase.appspot.com",messagingSenderId:"414022913198",appId:"1:414022913198:web:405b0ea2fc513c5548f13f",measurementId:"G-2VFFS4CNFJ"}),cg=(function(e=de()){const t=ce(e=_(e),it);t.isInitialized()?t.getImmediate():function(e,t={}){const n=ce(e,it);if(n.isInitialized()){const e=n.getImmediate();if(m(t,n.getOptions()))return e;throw at.create("already-initialized")}n.initialize({options:t})}(e)}(ag),function(e=de()){const t=ce(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){const n=ce(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(m(n.getOptions(),null!=t?t:{}))return e;Ot(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Gi,persistence:[mi,Jn,ei]})}(ag)),ug=function(e,t){const n="string"==typeof e?e:"(default)";return ce("object"==typeof e?e:de(),"firestore").getImmediate({identifier:n})}(ag),lg=function(e=de(),t){return ce(e=_(e),ig).getImmediate({identifier:t})}(ag),hg=function(e){const t=[];return e.forEach((e=>{const n=e.data();t.push({id:e.id,...n})})),t},dg=function(e){return{id:e.id,...e.data()}},fg=(e.p,e.p,function(e){return e.startsWith("/")||(e="/"+e),e.endsWith("/")||(e+="/"),e}),pg=function(e,t){return fg(t.pathname).match((n=(n=fg(e.path)).replace(/\//g,"\\/").replace(/:[-\w]+/g,"([-\\w]+)").replace(/\*/g,"(.+)"),new RegExp("^"+n+"$")));var n},mg=function(e,t){this.path=e,this.fn=t},gg=function(){this.routes=[]};gg.prototype.path=function(e,t){const n=new mg(e,t);return this.routes.push(n),this},gg.prototype.run=function(e,t,n){const i={url:e,root:t,components:n};for(const t of this.routes)if(t.constructor===mg&&pg(t,e)){t.fn(i);break}},gg.start=function(e,t,n){e.run(location,t,n)};const yg=e=>document.querySelector(e);function vg(){return'\n        <section class="auth">\n            <container>\n                <inner>\n                    <form>\n                        <box>\n                            <h2>WELCOME BACK</h2>\n                            <p>Please enter your details to continue</p>\n                        </box>\n                        <box>\n                            <input id="username" type="text" placeholder="Username">\n                            <input id="password" type="text" placeholder="Password">\n                        </box>\n                        <box>\n                            <input id="submit" type="submit" value="LOGIN">\n                            <span>Forgot Password? <a href="/reset">Reset</a></span>\n                        </box>\n                    </form>\n                </inner>\n            </container>\n        </section>\n    '}function wg(){return'\n        <section class="auth">\n            <container>\n                <inner>\n                    <form>\n                        <box>\n                            <h2>CREATE ACCOUNT</h2>\n                            <p>Please enter your details to continue</p>\n                        </box>\n                        <box>\n                            <input id="name" type="text" placeholder="Full Name">\n                            <input id="email" type="email" placeholder="Your Email">\n                            <input id="username" type="text" placeholder="Username">\n                            <input id="password" type="text" placeholder="Password">\n                        </box>\n                        <box>\n                            <input id="submit" type="submit" value="SIGNUP">\n                            <span>By signing up, you agree to our <br> <a href="/terms-and-conditions">Terms & Conditions</a> and <a href="/privacy-policy">Privacy Policy</a></span>\n                        </box>\n                    </form>\n                </inner>\n            </container>\n        </section>\n    '}function bg(e,t){return`\n        <section class="spotlight">\n            <container>\n                <inner>\n                    ${e.map((e=>`\n                                <slide>\n                                    <img src="${e.cover}" alt="image">\n                                    <p class="genre">${e.genre}</p>\n                                    <div>\n                                        <p class="title">${e.title}</p>\n                                        <p class="description">${e.description}</p>\n                                        <tab>\n                                            <a class="cta" href="/novels/${e.id}">READ NOW</a>\n                                            <a>SUBSCRIBE</a>\n                                        </tab>\n                                    </div>\n                                </slide>\n                            `)).join("")}\n                    ${t?"":'\n                            <box>\n                                <i class="left">chevron_left</i>\n                                <i class="right">chevron_right</i>\n                            </box>\n                        '}\n                    \n                </inner>\n            </container>\n        </section>\n    `}function Ig(e,t){e.forEach((e=>e.removeAttribute("active"))),e[t.currSlide].setAttribute("active",!0)}function Tg(e,t){t.currSlide===t.numSlides-1?t.currSlide=0:t.currSlide++,Ig(e,t)}function _g(e,t){t.interval=setInterval((()=>{Tg(e,t)}),t.slideTime)}function Eg(e,t){clearInterval(t.interval),_g(e,t)}function Sg(){return'\n        <section class="auth new-novel">\n            <container>\n                <inner>\n                    <form>\n                        <box>\n                            <h2>CREATE NEW NOVEL</h2>\n                            <p>Please enter the details to continue</p>\n                        </box>\n                        <box>\n                            <input id="title" type="text" placeholder="Title">\n                            <textarea id="description" type="text" placeholder="Description"></textarea>\n                            <input id="genre" type="text" placeholder="Genre">\n                            <label for="cover">Select Cover Image</label>\n                            <input id="cover" style="visibility: hidden" type="file" accept="image/*" placeholder="Cover">\n                        </box>\n                        <box>\n                            <input id="submit" type="submit" value="CREATE">\n                        </box>\n                    </form>\n                </inner>\n            </container>\n        </section>\n    '}function kg(e){return'\n        <section class="novel">\n            <container>\n                <inner>\n                    \n                </inner>\n            </container>\n        </section>\n    '}function Cg(e){return`\n        <section class="auth new-novel">\n            <container>\n                <inner>\n                    <form>\n                        <box>\n                            <h2>EDIT YOUR NOVEL</h2>\n                            <p>Please enter the details to continue</p>\n                        </box>\n                        <box>\n                            <input id="title" type="text" placeholder="Title" value="${e.title}">\n                            <textarea id="description" type="text" value="${e.description}" placeholder="Description"></textarea>\n                            <input id="genre" type="text" placeholder="Genre">\n                            <label for="cover">Select Cover Image</label>\n                            <input id="cover" style="visibility: hidden" type="file" accept="image/*" placeholder="Cover">\n                        </box>\n                        <box>\n                            <input id="submit" type="submit" value="CREATE">\n                        </box>\n                    </form>\n                </inner>\n            </container>\n        </section>\n    `}function Ag(){return'\n        <section class="auth new-novel">\n            <container>\n                <inner>\n                    <form>\n                        <box>\n                            <h2>CREATE NEW CHAPTER</h2>\n                            <p>Please enter the details to continue</p>\n                        </box>\n                        <box>\n                            <input id="title" type="text" placeholder="Title">\n                            <textarea id="body" type="text" rows="20" placeholder="Body"></textarea>\n                        </box>\n                        <box>\n                            <input id="submit" type="submit" value="CREATE">\n                        </box>\n                    </form>\n                </inner>\n            </container>\n        </section>\n    '}function Ng(e){return`\n        <section class="chapter">\n            <container>\n                <inner>\n                    <h2>${e.title}</h2>\n                    <p>${e.body}</p>\n                </inner>\n            </container>\n        </section>\n    `}yg.all=e=>document.querySelectorAll(e),yg.reflow=(e=document.body)=>{e.offsetHeight},vg.load=async function(){yg("section.auth"),yg("section.auth form").addEventListener("submit",(async e=>{e.preventDefault();const t=yg("#username").value,n=yg("#password").value;console.log(t),console.log(n);const i=Xp(mp(ug,"users"),function(e,t,n){const i=zp("where","username");return new Jp(i,"==",n)}(0,0,t)),r=await rm(i),s=hg(r)[0];await function(e,t,n){return async function(e,t){return Wn(An(e),t)}(_(e),Un.credential(t,n))}(cg,s.email,n),location.href=location.origin+"/"}))},wg.load=async function(){yg("section.auth"),yg("section.auth form").addEventListener("submit",(async e=>{e.preventDefault();const t=yg("#name").value,n=yg("#email").value,i=yg("#username").value,r=yg("#password").value,s=await async function(e,t,n){const i=An(e),r=await async function(e,t){return Yt(e,"POST","/v1/accounts:signUp",Gt(e,t))}(i,{returnSecureToken:!0,email:t,password:n}),s=await Hn._fromIdTokenResponse(i,"signIn",r);return await i._updateCurrentUser(s.user),s}(cg,n,r),o=s.user;await function(e,t,n){e=up(e,dp);const i=up(e.firestore,vp),r=tm(e.converter,t,n);return am(i,[Op(Dp(i),"setDoc",e._key,r,null!==e.converter,n).toMutation(e._key,Dl.none())])}(gp(ug,"users",o.uid),{name:t,email:n,username:i}),location.href=location.origin+"/"}))},bg.load=function(){yg.reflow();const e=yg("section.spotlight"),t=yg.all("section.spotlight slide"),n={currSlide:0,numSlides:t.length,slideTime:4e3};Ig(t,n),_g(t,n),e.addEventListener("click",(e=>{const i=e.target;i&&(i.classList.contains("left")?(function(e,t){0===t.currSlide?t.currSlide=t.numSlides-1:t.currSlide--,Ig(e,t)}(t,n),Eg(t,n)):i.classList.contains("right")&&(Tg(t,n),Eg(t,n)))}))},Sg.load=async function(e){yg("section.auth"),yg("section.auth form").addEventListener("submit",(async t=>{t.preventDefault();const n=yg("#title").value;let i=yg("#description").value;const r=yg("#genre").value,s=yg("#cover").files[0];i="lorem"!==i?i:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum",console.log(n),console.log(i),console.log(r),console.log(s);const o=await om(mp(ug,"novels"),{title:n,description:i,genre:r}),a=og(lg,"novels/"+o.id);await rg(a,s);const c=await sg(a);await sm(gp(ug,"novels",o.id),{cover:c});let u=[o.id];e.user.createdNovels&&e.user.createdNovels.length&&(e.user.createdNovels.unshift(o.id),u=e.user.createdNovels),await sm(gp(ug,"users",e.user.id),{createdNovels:u}),location.href=location.origin+"/user"}))},kg.load=async function(e){yg("section.auth"),yg("section.auth form").addEventListener("submit",(async t=>{t.preventDefault();const n=yg("#title").value;let i=yg("#description").value;const r=yg("#genre").value,s=yg("#cover").files[0];i="lorem"!==i?i:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum",console.log(n),console.log(i),console.log(r),console.log(s);const o=await om(mp(ug,"novels"),{title:n,description:i,genre:r}),a=og(lg,"novels/"+o.id);await rg(a,s);const c=await sg(a);await sm(gp(ug,"novels",o.id),{cover:c}),await sm(gp(ug,"users",e.user.id),{createdNovels:e.user.createdNovels?e.user.createdNovels.unshift(o.id):[o.id]}),location.href=location.origin+"/user"}))},Cg.load=async function(e){yg("section.auth"),yg("section.auth form").addEventListener("submit",(async t=>{t.preventDefault();const n=yg("#title").value;let i=yg("#description").value;const r=yg("#genre").value,s=yg("#cover").files[0];i="lorem"!==i?i:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum",console.log(n),console.log(i),console.log(r),console.log(s);const o=await om(mp(ug,"novels"),{title:n,description:i,genre:r}),a=og(lg,"novels/"+o.id);await rg(a,s);const c=await sg(a);await sm(gp(ug,"novels",o.id),{cover:c});const u=void 0!==e.user.createdNovels.length?e.user.createdNovels.unshift(o.id):[o.id];await sm(gp(ug,"users",e.user.id),{createdNovels:u}),location.href=location.origin+"/user"}))},Ag.load=async function(e,t){yg("section.auth"),yg("section.auth form").addEventListener("submit",(async e=>{e.preventDefault();const n=yg("#title").value;let i=yg("#body").value;i="lorem"!==i?description:'The standard Lorem Ipsum passage, used since the 1500s\n"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."\n\nSection 1.10.32 of "de Finibus Bonorum et Malorum", written by Cicero in 45 BC\n"Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?"\n\n1914 translation by H. Rackham\n"But I must explain to you how all this mistaken idea of denouncing pleasure and praising pain was born and I will give you a complete account of the system, and expound the actual teachings of the great explorer of the truth, the master-builder of human happiness. No one rejects, dislikes, or avoids pleasure itself, because it is pleasure, but because those who do not know how to pursue pleasure rationally encounter consequences that are extremely painful. Nor again is there anyone who loves or pursues or desires to obtain pain of itself, because it is pain, but because occasionally circumstances occur in which toil and pain can procure him some great pleasure. To take a trivial example, which of us ever undertakes laborious physical exercise, except to obtain some advantage from it? But who has any right to find fault with a man who chooses to enjoy a pleasure that has no annoying consequences, or one who avoids a pain that produces no resultant pleasure?"\n\nSection 1.10.33 of "de Finibus Bonorum et Malorum", written by Cicero in 45 BC\n"At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor repellendus. Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint et molestiae non recusandae. Itaque earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat."\n\n1914 translation by H. Rackham\n"On the other hand, we denounce with righteous indignation and dislike men who are so beguiled and demoralized by the charms of pleasure of the moment, so blinded by desire, that they cannot foresee the pain and trouble that are bound to ensue; and equal blame belongs to those who fail in their duty through weakness of will, which is the same as saying through shrinking from toil and pain. These cases are perfectly simple and easy to distinguish. In a free hour, when our power of choice is untrammelled and when nothing prevents our being able to do what we like best, every pleasure is to be welcomed and every pain avoided. But in certain circumstances and owing to the claims of duty or the obligations of business it will frequently occur that pleasures have to be repudiated and annoyances accepted. The wise man therefore always holds in these matters to this principle of selection: he rejects pleasures to secure other greater pleasures, or else he endures pains to avoid worse pains.',console.log(n),console.log(i);const r=await om(mp(ug,"chapters"),{title:n,body:i}),s=gp(ug,"novels",t),o=await nm(s),a=dg(o);let c=[r.id];a.chapters&&a.chapters.length&&(a.chapters.push(r.id),c=a.chapters),console.log(c),await sm(gp(ug,"novels",t),{chapters:c}),location.href=location.origin+"/novels/"+t}))},Ng.load=async function(e){};const Rg={Header:function({root:e,type:t,id:n}){let i='\n        <header>\n            <container>\n                <inner>\n                    <nav>\n                        <a class="logo" href="/">NOVELLERY</a>\n                    </nav>\n                    <nav>\n                        <a class="link" href="/login">LOGIN</a>\n                        <a class="link" href="/signup">SIGNUP</a>\n                    </nav>\n                </inner>\n            </container>\n        </header>\n    ';return 1===t&&(i=`\n        <header>\n            <container>\n                <inner>\n                    <nav>\n                        <a class="logo" href="/">NOVELLERY</a>\n                    </nav>\n                    <nav>\n                        ${e.user?'\n                            <a class="link" href="/create-novel" >CREATE NOVEL</a>\n                            <a class="link" href="/logout" style="color: lightcoral">LOGOUT</a>\n                        ':`\n                            <a class="btn" href="${e.user?"/user":"/login"}"><i>person</i></a>\n                        `}\n                    </nav>\n                </inner>\n            </container>\n        </header>\n    `),2===t&&(i=' \n        <header>\n            <container>\n                <inner>\n                    <nav>\n                        <a class="logo" href="/">NOVELLERY</a>\n                    </nav>\n                    <nav>\n                        <a class="link" href="/create-novel" >CREATE NOVEL</a>\n                        <a class="link" href="/logout" style="color: lightcoral">LOGOUT</a>\n                    </nav>\n                </inner>\n            </container>\n        </header>\n    '),3===t&&(i=`\n        <header>\n            <container>\n                <inner>\n                    <nav>\n                        <a class="logo" href="/">NOVELLERY</a>\n                    </nav>\n                    <nav>\n\x3c!--                        <a class="link" href="/novels/${n}/edit" >EDIT NOVEL</a>--\x3e\n                        <a class="link" href="/novels/${n}/create-chapter" >CREATE CHAPTER</a>\n                        <a class="link" href="/logout" style="color: lightcoral">LOGOUT</a>\n                    </nav>\n                </inner>\n            </container>\n        </header>\n    `),i},Login:vg,Signup:wg,Verify:function(){return'\n        <section class="auth">\n            <container>\n                <inner>\n                    <form>\n                        <box>\n                            <h2>VERIFY EMAIL</h2>\n                            <p>Please check your email for code</p>\n                        </box>\n                        <box>\n                            <input id="code" type="text" placeholder="Code">\n                        </box>\n                        <box>\n                            <input id="submit" type="submit" value="VERIFY">\n                            <span>Don\'t Received Code? <a href="/verify">Resend</a></span>\n                        </box>\n                    </form>\n                </inner>\n            </container>\n        </section>\n    '},Reset:function(){return'\n        <section class="auth">\n            <container>\n                <inner>\n                    <form>\n                        <box>\n                            <h2>RESET PASSWORD</h2>\n                            <p>Please enter the details to continue</p>\n                        </box>\n                        <box>\n                            <input id="email" type="text" placeholder="Your Email">\n                            <input id="password" type="text" placeholder="New Password">\n                        </box>\n                        <box>\n                            <input id="submit" type="submit" value="RESET">\n                            <span>Back to <a href="/login">Login</a></span>\n                        </box>\n                    </form>\n                </inner>\n            </container>\n        </section>\n    '},Spotlight:bg,Tray:function(e){return`\n        <section class="tray">\n            <container>\n                <inner>\n                    <h2><span>${e.title}</span>&nbsp;<i>arrow_forward_ios</i></h2>\n                    <box>\n                    ${e.novels?.map((e=>`\n                            <a class="card" href="/novels/${e.id}">\n                                <img src="${e.cover}" alt="cover">\n                                <div>\n                                    <h3>${e.title}</h3>\n                                    <p>${e.genre}</p>\n                                </div>\n                            </a>\n                        `)).join("")}\n                    </box>\n                </inner>\n            </container>\n        </section>\n    `},NewNovel:Sg,Novel:kg,EditNovel:Cg,NewChapter:Ag,Chapter:Ng},Dg=new gg,Og=yg("root");Dg.path("/",(async function({root:e,components:t}){console.log("Home");const n=Xp(mp(ug,"novels")),i=await rm(n),r=hg(i);e.innerHTML=`\n        ${t.Header({root:e,type:1})}\n        ${t.Spotlight(r)}\n        ${t.Tray({title:"TRENDING NOVELS",novels:r})}\n        ${t.Tray({title:"ONGOING NOVELS",novels:r})}\n        ${t.Tray({title:"COMPLETED NOVELS",novels:r})}\n        ${t.Tray({title:"UPCOMING NOVELS",novels:r})}\n    `,t.Spotlight.load()})),Dg.path("/login",(function({root:e,components:t}){console.log("Login"),e.user?location.href=location.origin+"/":(e.innerHTML=`\n        ${t.Header({})}\n        ${t.Login()}\n    `,t.Login.load())})),Dg.path("/signup",(function({root:e,components:t}){console.log("Signup"),e.user?location.href=location.origin+"/":(e.innerHTML=`\n        ${t.Header({})}\n        ${t.Signup()}\n    `,t.Signup.load())})),Dg.path("/verify",(function({root:e,components:t}){console.log("Verify"),e.innerHTML=`\n        ${t.Header()}\n        ${t.Verify()}\n    `})),Dg.path("/reset",(function({root:e,components:t}){console.log("Reset"),e.innerHTML=`\n        ${t.Header()}\n        ${t.Reset()}\n    `})),Dg.path("/user",(function({root:e,components:t}){console.log("User"),e.user?(console.log(e.user),e.innerHTML=` \n        ${t.Header({root:e,type:2})}\n        ${t.Tray({title:"CREATED NOVELS"})}\n        ${t.Tray({title:"SUBSCRIBED NOVELS"})}\n    `):location.href=location.origin+"/login"})),Dg.path("/logout",(async()=>{await cg.signOut(),location.href=location.origin+"/"})),Dg.path("/create-novel",(function({root:e,components:t}){console.log("Create Novel"),e.user?(e.innerHTML=`\n        ${t.Header({root:e,type:1})}\n        ${t.NewNovel()}\n    `,t.NewNovel.load(e)):location.href=location.origin+"/login"})),Dg.path("/novels/:novelID/edit",(async function({url:e,root:t,components:n}){if(console.log("Edit Novel"),!t.user)return void(location.href=location.origin+"/login");const i=e.href.split("/").reverse()[1],r=gp(ug,"novels",i),s=await nm(r),o=dg(s);t.innerHTML=`\n        ${n.Header({root:t,type:1})}\n        ${n.EditNovel(o)}\n    `,n.EditNovel.load(t)})),Dg.path("/novels/:novelID",(async function({url:e,root:t,components:n}){console.log("Novel");const i=e.href.split("/").pop(),r=gp(ug,"novels",i),s=await nm(r),o=dg(s);let a;console.log([o]),t.user&&t.user.createdNovels.includes(o.id)&&(a=!0),console.log(a),t.innerHTML=`\n        ${n.Header({root:t,type:a?3:1,id:i})}\n        ${n.Spotlight([o],!0)}\n        \n        <section class="chapters">\n            <container>\n                <inner>\n                    <h2>CHAPTERS</h2>\n                    <box>\n                        ${o.chapters?.map(((e,t)=>`\n                                    <a href="/chapters/${e}"><span># ${t+1}</span><i>arrow_forward_ios</i></a>\n                                `)).join("")}\n                    </box>\n                </inner>\n            </container>\n        </section>\n    `,n.Spotlight.load()})),Dg.path("/novels/:novelID/create-chapter",(function({url:e,root:t,components:n}){if(console.log("Create Chapter"),!t.user)return void(location.href=location.origin+"/login");const i=e.href.split("/").reverse()[1];console.log(i),t.innerHTML=`\n        ${n.Header({root:t,type:1})}\n        ${n.NewChapter()}\n    `,n.NewChapter.load(t,i)})),Dg.path("/chapters/:id",(async function({url:e,root:t,components:n}){console.log("Novel");const i=e.href.split("/").reverse()[0],r=gp(ug,"chapters",i),s=await nm(r),o=dg(s);console.log(o),t.innerHTML=`\n        ${n.Header({root:t,type:1})}\n        ${n.Chapter(o)}\n    `,n.Chapter.load()})),Dg.start=!1,cg.onAuthStateChanged((async e=>{if(!Dg.start){if(e){const t=gp(ug,"users",e.uid),n=await nm(t);Og.user=dg(n)}gg.start(Dg,Og,Rg)}}))})();
//# sourceMappingURL=app.js.map